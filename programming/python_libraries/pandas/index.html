
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../matplotlib/">
      
      
        <link rel="next" href="../../sql/introduction/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.3">
    
    
      
        <title>Pandas - Python and data science</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6b71719e.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pandas" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Python and data science" class="md-header__button md-logo" aria-label="Python and data science" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Python and data science
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Pandas
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Python and data science" class="md-nav__button md-logo" aria-label="Python and data science" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Python and data science
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" tabindex="0" aria-expanded="false">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/python_introduction/" class="md-nav__link">
        Introduction to Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/control_flow/" class="md-nav__link">
        Control flow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/data_structures/" class="md-nav__link">
        Data structures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/functions/" class="md-nav__link">
        Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/python_programs/" class="md-nav__link">
        Python programs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/io_files/" class="md-nav__link">
        Input, output and files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/exceptions/" class="md-nav__link">
        Exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/classes/" class="md-nav__link">
        Classes and objects
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/python_packages/" class="md-nav__link">
        Python packages
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" tabindex="0" aria-expanded="true">
          Data science libraries
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data science libraries" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Data science libraries
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../numpy/" class="md-nav__link">
        Numpy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../matplotlib/" class="md-nav__link">
        Matplotlib
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Pandas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Pandas
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pandas-vs-excel" class="md-nav__link">
    Pandas vs. Excel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-objects-series-and-dataframes" class="md-nav__link">
    Basic objects: Series and Dataframes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#series-creation" class="md-nav__link">
    Series creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframe-creation" class="md-nav__link">
    Dataframe creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#readingwriting-dataframes" class="md-nav__link">
    Reading/writing dataframes
  </a>
  
    <nav class="md-nav" aria-label="Reading/writing dataframes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reading-from-a-csv" class="md-nav__link">
    Reading from a CSV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-to-a-csv" class="md-nav__link">
    Saving to a CSV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-a-dataframe-to-a-dictionary" class="md-nav__link">
    Converting a dataframe to a dictionary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-dataframes" class="md-nav__link">
    Viewing DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-data-in-a-dataframe" class="md-nav__link">
    Accessing data in a DataFrame
  </a>
  
    <nav class="md-nav" aria-label="Accessing data in a DataFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accessing-data-in-one-ore-more-columns" class="md-nav__link">
    Accessing data in one ore more columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slicing" class="md-nav__link">
    Slicing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-rows-and-columns-at-the-same-time" class="md-nav__link">
    Selecting rows and columns at the same time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-data-from-its-location-on-the-dataframe" class="md-nav__link">
    Accessing data from its location on the DataFrame
  </a>
  
    <nav class="md-nav" aria-label="Accessing data from its location on the DataFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#column-selectors" class="md-nav__link">
    Column selectors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#row-selectors" class="md-nav__link">
    Row selectors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-new-values-on-a-dataframe" class="md-nav__link">
    Setting new values on a DataFrame
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-dataframes" class="md-nav__link">
    Working with DataFrames
  </a>
  
    <nav class="md-nav" aria-label="Working with DataFrames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-tasks" class="md-nav__link">
    Common tasks
  </a>
  
    <nav class="md-nav" aria-label="Common tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#finding-the-size-of-a-dataframe" class="md-nav__link">
    Finding the size of a DataFrame
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-duplicates" class="md-nav__link">
    Removing duplicates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filling-missing-data" class="md-nav__link">
    Filling missing data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resetting-the-index" class="md-nav__link">
    Resetting the index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renaming-columns" class="md-nav__link">
    Renaming columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sorting" class="md-nav__link">
    Sorting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-new-columns" class="md-nav__link">
    Creating new columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#counting-unique-values" class="md-nav__link">
    Counting unique values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pivoting-a-dataframe-with-melt-untidy-to-tidy-data" class="md-nav__link">
    Pivoting a dataframe with melt: untidy to tidy data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-statistics" class="md-nav__link">
    Basic statistics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applying-custom-functions" class="md-nav__link">
    Applying custom functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-by" class="md-nav__link">
    Group by
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joins-and-merges" class="md-nav__link">
    Joins and merges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenating-dataframes" class="md-nav__link">
    Concatenating DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-types-and-memory-usage" class="md-nav__link">
    Variable types and memory usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" tabindex="0" aria-expanded="false">
          SQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SQL" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          SQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/introduction/" class="md-nav__link">
        SQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/select_statements/" class="md-nav__link">
        SELECT statement
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/window_functions/" class="md-nav__link">
        Window functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/modification_statements/" class="md-nav__link">
        Data modification statements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/table_operations/" class="md-nav__link">
        Table operations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/sql_from_python/" class="md-nav__link">
        SQL queries from Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pandas-vs-excel" class="md-nav__link">
    Pandas vs. Excel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-objects-series-and-dataframes" class="md-nav__link">
    Basic objects: Series and Dataframes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#series-creation" class="md-nav__link">
    Series creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframe-creation" class="md-nav__link">
    Dataframe creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#readingwriting-dataframes" class="md-nav__link">
    Reading/writing dataframes
  </a>
  
    <nav class="md-nav" aria-label="Reading/writing dataframes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reading-from-a-csv" class="md-nav__link">
    Reading from a CSV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-to-a-csv" class="md-nav__link">
    Saving to a CSV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-a-dataframe-to-a-dictionary" class="md-nav__link">
    Converting a dataframe to a dictionary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-dataframes" class="md-nav__link">
    Viewing DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-data-in-a-dataframe" class="md-nav__link">
    Accessing data in a DataFrame
  </a>
  
    <nav class="md-nav" aria-label="Accessing data in a DataFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accessing-data-in-one-ore-more-columns" class="md-nav__link">
    Accessing data in one ore more columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slicing" class="md-nav__link">
    Slicing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-rows-and-columns-at-the-same-time" class="md-nav__link">
    Selecting rows and columns at the same time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-data-from-its-location-on-the-dataframe" class="md-nav__link">
    Accessing data from its location on the DataFrame
  </a>
  
    <nav class="md-nav" aria-label="Accessing data from its location on the DataFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#column-selectors" class="md-nav__link">
    Column selectors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#row-selectors" class="md-nav__link">
    Row selectors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-new-values-on-a-dataframe" class="md-nav__link">
    Setting new values on a DataFrame
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-dataframes" class="md-nav__link">
    Working with DataFrames
  </a>
  
    <nav class="md-nav" aria-label="Working with DataFrames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-tasks" class="md-nav__link">
    Common tasks
  </a>
  
    <nav class="md-nav" aria-label="Common tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#finding-the-size-of-a-dataframe" class="md-nav__link">
    Finding the size of a DataFrame
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-duplicates" class="md-nav__link">
    Removing duplicates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filling-missing-data" class="md-nav__link">
    Filling missing data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resetting-the-index" class="md-nav__link">
    Resetting the index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renaming-columns" class="md-nav__link">
    Renaming columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sorting" class="md-nav__link">
    Sorting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-new-columns" class="md-nav__link">
    Creating new columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#counting-unique-values" class="md-nav__link">
    Counting unique values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pivoting-a-dataframe-with-melt-untidy-to-tidy-data" class="md-nav__link">
    Pivoting a dataframe with melt: untidy to tidy data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-statistics" class="md-nav__link">
    Basic statistics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applying-custom-functions" class="md-nav__link">
    Applying custom functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-by" class="md-nav__link">
    Group by
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joins-and-merges" class="md-nav__link">
    Joins and merges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenating-dataframes" class="md-nav__link">
    Concatenating DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-types-and-memory-usage" class="md-nav__link">
    Variable types and memory usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="pandas">Pandas<a class="headerlink" href="#pandas" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Pandas is a high-level data manipulation tool built with the Numpy package. Its key data structure is called the 
DataFrame, which allow us to store and manipulate tabular data (we can think of the rows as different "observations" 
and the columns as the variables).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Intuitively, pandas DataFrames can be thought of as a way to hold Excel spreadsheets data in a
Python object.</p>
</div>
<p>Since Pandas <strong>is not</strong> part of the standard Python library, we will need to install it first in the virtual 
environment, for instance with <code>pip</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip<span class="w"> </span>install<span class="w"> </span>pandas
</code></pre></div>
<p>Once we have it installed, to use it in the code will need to import it with</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">pandas</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># Code here</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">...</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Often, pandas is renamed to <code>pd</code> in the import, as:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</code></pre></div>
This is of course not mandatory, but very common.    </p>
</div>
<p>After importing the package, we can start using its most important object, the DataFrame. 
There are several ways to create a DataFrame, for example:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Brazil&quot;</span><span class="p">,</span> <span class="s2">&quot;Russia&quot;</span><span class="p">,</span> <span class="s2">&quot;India&quot;</span><span class="p">,</span> <span class="s2">&quot;China&quot;</span><span class="p">,</span> <span class="s2">&quot;South Africa&quot;</span><span class="p">],</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>       <span class="s2">&quot;capital&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Brasilia&quot;</span><span class="p">,</span> <span class="s2">&quot;Moscow&quot;</span><span class="p">,</span> <span class="s2">&quot;New Dehli&quot;</span><span class="p">,</span> <span class="s2">&quot;Beijing&quot;</span><span class="p">,</span> <span class="s2">&quot;Pretoria&quot;</span><span class="p">],</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>       <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">8.516</span><span class="p">,</span> <span class="mf">17.10</span><span class="p">,</span> <span class="mf">3.286</span><span class="p">,</span> <span class="mf">9.597</span><span class="p">,</span> <span class="mf">1.221</span><span class="p">],</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>       <span class="s2">&quot;population&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">200.4</span><span class="p">,</span> <span class="mf">143.5</span><span class="p">,</span> <span class="mi">1252</span><span class="p">,</span> <span class="mi">1357</span><span class="p">,</span> <span class="mf">52.98</span><span class="p">]</span> <span class="p">}</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">brics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">brics</span><span class="p">)</span>
</code></pre></div>
which outputs
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>     area    capital       country  population
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>0   8.516   Brasilia        Brazil      200.40
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>1  17.100     Moscow        Russia      143.50
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>2   3.286  New Dehli         India     1252.00
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>3   9.597    Beijing         China     1357.00
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>4   1.221   Pretoria  South Africa       52.98
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want a nice, complete introduction and walkthrough to Pandas, it is recommended
to check the official documentation's own <a href="https://pandas.pydata.org/docs/user_guide/10min.html">guide</a>.
The notes in this page are not comprehensive.</p>
</div>
<h3 id="pandas-vs-excel">Pandas vs. Excel<a class="headerlink" href="#pandas-vs-excel" title="Permanent link">&para;</a></h3>
<p>Tasks such as data cleaning, data normalization, visualization, and statistical analysis can be performed on 
both Excel and Pandas. That being said, Pandas has some major benefits over Excel:</p>
<ul>
<li>Limitation by size: Excel can handle around 1 million rows, while Python can handle millions and millions of rows 
(the limitation is on PC computing power and memory).</li>
<li>Complex data transformation: Memory-intensive computations in Excel can crash a workbook. 
Python can handle complex computations without major problems.</li>
<li>Automation: Excel was not designed to automate tasks. You can create a macro or use VBA to simplify some tasks, 
but Python is a general programming language (meaning we can program almost anything).</li>
</ul>
<h3 id="basic-objects-series-and-dataframes">Basic objects: Series and Dataframes<a class="headerlink" href="#basic-objects-series-and-dataframes" title="Permanent link">&para;</a></h3>
<p>Fundamentally, Pandas has two main objects that we will be using: </p>
<ul>
<li><strong>Pandas Series</strong> are one-dimensional labeled arrays capable of holding any data 
type (integers, strings, floating point numbers, Python objects, etc.). We can think of a Pandas Series
as a single "column" of a table.</li>
<li><strong>Pandas Dataframes</strong> are 2-dimensional labeled data structures with columns of potentially different 
types. We can think of it like a spreadsheet or SQL table, or a dict of Series objects. </li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In general we will only be using Pandas Dataframes, which are the most commonly used pandas object.
However, since Pandas Dataframes are a collection of Pandas Series, Series will appear often as the
result of using some of the methods of Dataframes.</p>
</div>
<h3 id="series-creation">Series creation<a class="headerlink" href="#series-creation" title="Permanent link">&para;</a></h3>
<p>In a Series object, the axis labels are collectively referred to as the <strong>index</strong>. The basic method 
to create a Series is to call:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>
<p>Here, data can be many different things, for example:</p>
<ul>
<li>A Python dict or list</li>
<li>A scalar value</li>
<li>A numpy array</li>
</ul>
<p>If <code>data</code> is a numpy array, index must be the same length as data. If no index is passed, 
one will be created having values <code>[0, ..., len(data) - 1]</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">s</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> 
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">a</span>    <span class="mf">0.469112</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="n">b</span>   <span class="o">-</span><span class="mf">0.282863</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">c</span>   <span class="o">-</span><span class="mf">1.509059</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">d</span>   <span class="o">-</span><span class="mf">1.135632</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="n">e</span>    <span class="mf">1.212112</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="n">s</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> 
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="mi">0</span>   <span class="o">-</span><span class="mf">0.173215</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="mi">1</span>    <span class="mf">0.119209</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="mi">2</span>   <span class="o">-</span><span class="mf">1.044236</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="mi">3</span>   <span class="o">-</span><span class="mf">0.861849</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="mi">4</span>   <span class="o">-</span><span class="mf">2.104569</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</code></pre></div>
<h3 id="dataframe-creation">Dataframe creation<a class="headerlink" href="#dataframe-creation" title="Permanent link">&para;</a></h3>
<p>DataFrames are, in practice, a dictionary of columns. That's why <strong>column labels must be unique</strong>. 
Each column corresponds to a <code>Series</code>, and different columns can be of different type. Rows are 
identified by an index, shared by all the columns (and may be non-unique). </p>
<p>To instantiate a DataFrame we may use different kinds of input, such as:</p>
<ul>
<li>
<p>A <code>dict</code> of 1D objects: Numpy arrays, lists, dicts, or Series. In any case, the arrays must all be the same length. 
If an index is passed, it must also be the same length as the arrays. If no index is passed, the result will be 
<code>range(n)</code>, where <code>n</code> is the array length:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;one&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span> <span class="s2">&quot;two&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]}</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">Out</span><span class="p">[</span><span class="mi">46</span><span class="p">]:</span> 
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>   <span class="n">one</span>  <span class="n">two</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="mi">0</span>  <span class="mf">1.0</span>  <span class="mf">4.0</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="mi">1</span>  <span class="mf">2.0</span>  <span class="mf">3.0</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="mi">2</span>  <span class="mf">3.0</span>  <span class="mf">2.0</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="mi">3</span>  <span class="mf">4.0</span>  <span class="mf">1.0</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">])</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="n">Out</span><span class="p">[</span><span class="mi">47</span><span class="p">]:</span> 
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>   <span class="n">one</span>  <span class="n">two</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="n">a</span>  <span class="mf">1.0</span>  <span class="mf">4.0</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="n">b</span>  <span class="mf">2.0</span>  <span class="mf">3.0</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="n">c</span>  <span class="mf">3.0</span>  <span class="mf">2.0</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="n">d</span>  <span class="mf">4.0</span>  <span class="mf">1.0</span>
</code></pre></div>
</li>
<li>
<p>From a list of dicts (where each dict has the same keys, which correspond to the DataFrame-to-be columns):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">In</span> <span class="p">[</span><span class="mi">53</span><span class="p">]:</span> <span class="n">data2</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}]</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">In</span> <span class="p">[</span><span class="mi">54</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">Out</span><span class="p">[</span><span class="mi">54</span><span class="p">]:</span> 
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>   <span class="n">a</span>   <span class="n">b</span>     <span class="n">c</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="mi">0</span>  <span class="mi">1</span>   <span class="mi">2</span>   <span class="n">NaN</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="mi">1</span>  <span class="mi">5</span>  <span class="mi">10</span>  <span class="mf">20.0</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="n">In</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;second&quot;</span><span class="p">])</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="n">Out</span><span class="p">[</span><span class="mi">55</span><span class="p">]:</span> 
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>        <span class="n">a</span>   <span class="n">b</span>     <span class="n">c</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="n">first</span>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="n">NaN</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="n">second</span>  <span class="mi">5</span>  <span class="mi">10</span>  <span class="mf">20.0</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="n">In</span> <span class="p">[</span><span class="mi">56</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">])</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="n">Out</span><span class="p">[</span><span class="mi">56</span><span class="p">]:</span> 
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>   <span class="n">a</span>   <span class="n">b</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="mi">0</span>  <span class="mi">1</span>   <span class="mi">2</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="mi">1</span>  <span class="mi">5</span>  <span class="mi">10</span>
</code></pre></div>
</li>
<li>
<p>Tables from a <code>.csv</code> file or Excel file (e.g., <code>.xlsx</code>)</p>
</li>
<li>A single Pandas Series</li>
<li>2-D numpy.ndarray</li>
</ul>
<p>In any case, the DataFrame construction always follows the same syntax:
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c1"># suppose &quot;a&quot; is a Python object type that can be converted to a DataFrame</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">a</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="c1"># DataFrame object creation</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although Series are 1D, nothing prevents us from converting a Pandas Series into a Pandas DataFrame.
This is often very convenient since DataFrames and Series do not have the same methods available.</p>
</div>
<h3 id="readingwriting-dataframes">Reading/writing dataframes<a class="headerlink" href="#readingwriting-dataframes" title="Permanent link">&para;</a></h3>
<p>Dataframes are very useful, but how can we transfer tabular information between different Python sessions?</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember that information stored in Python objects disappears once the current execution is finished.</p>
</div>
<p>The most common way to achieve this is to save the tables in files. These files can be reused in future executions,
or transferred through the internet (this is mostly how we download datasets from the internet).</p>
<p>A simple way to store big data sets is to use <code>.csv</code> files (comma separated files). CSV files contain
plain text and is a well known format that can be read by everyone (including Pandas).</p>
<h4 id="reading-from-a-csv">Reading from a CSV<a class="headerlink" href="#reading-from-a-csv" title="Permanent link">&para;</a></h4>
<p>Reading from a CSV is as easy as:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">)</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span> 
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="c1"># Output</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>     <span class="n">Duration</span>  <span class="n">Pulse</span>  <span class="n">Maxpulse</span>  <span class="n">Calories</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="mi">0</span>          <span class="mi">60</span>    <span class="mi">110</span>       <span class="mi">130</span>     <span class="mf">409.1</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="mi">1</span>          <span class="mi">60</span>    <span class="mi">117</span>       <span class="mi">145</span>     <span class="mf">479.0</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="mi">2</span>          <span class="mi">60</span>    <span class="mi">103</span>       <span class="mi">135</span>     <span class="mf">340.0</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="mi">3</span>          <span class="mi">45</span>    <span class="mi">109</span>       <span class="mi">175</span>     <span class="mf">282.4</span>
</code></pre></div>
<p>If the file has a header, or uses different characters (instead of commas), the pandas documentation has
several examples on how to use the <code>.read_csv()</code> method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the previous example, the <code>to_string()</code> method is not really necessary. This method is used
to make sure that we are printing the whole DataFrame (otherwise, if it has many columns and rows, 
pandas might shorten it when we try to print).</p>
</div>
<h4 id="saving-to-a-csv">Saving to a CSV<a class="headerlink" href="#saving-to-a-csv" title="Permanent link">&para;</a></h4>
<p>Saving an already existing DataFrame <code>df</code> into a <code>.csv</code> can be accomplished with:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;file_name.csv&#39;</span><span class="p">)</span>
</code></pre></div>
<p>If you want to export without the index, simply add index=False;</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;file_name.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p>If you get a <code>UnicodeEncodeError</code>, simply add encoding='utf-8':</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;file_name.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div>
<h4 id="converting-a-dataframe-to-a-dictionary">Converting a dataframe to a dictionary<a class="headerlink" href="#converting-a-dataframe-to-a-dictionary" title="Permanent link">&para;</a></h4>
<p>We can convert a dataframe to a dictionary with the <code>.to_dict()</code> method. This method has several
options, but the most common one is to convert the dataframe to a dictionary of lists, where the keys
are the column names and the values are the values of each column:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    <span class="p">{</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>        <span class="s2">&quot;first&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Mary&quot;</span><span class="p">],</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>        <span class="s2">&quot;last&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span> <span class="s2">&quot;Bo&quot;</span><span class="p">],</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>        <span class="s2">&quot;job&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Nurse&quot;</span><span class="p">,</span> <span class="s2">&quot;Economist&quot;</span><span class="p">],</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>        <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">],</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>        <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">130</span><span class="p">,</span> <span class="mi">150</span><span class="p">],</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>    <span class="p">}</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="p">)</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="c1"># Output</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Mary&#39;</span><span class="p">},</span> 
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a> <span class="s1">&#39;last&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Doe&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Bo&#39;</span><span class="p">},</span> 
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a> <span class="s1">&#39;job&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Nurse&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Economist&#39;</span><span class="p">},</span> 
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">},</span> 
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">150</span><span class="p">}</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a> <span class="p">}</span>
</code></pre></div>
<p>There are other options, such as converting the dataframe to a dictionary of lists (<code>orient="list"</code>), or
to a list of dictionaries (<code>orient="records"</code>).</p>
<h3 id="viewing-dataframes">Viewing DataFrames<a class="headerlink" href="#viewing-dataframes" title="Permanent link">&para;</a></h3>
<p>To view the contents of a DataFrame, we can use one of several options:</p>
<ul>
<li>Using the <code>print(some_dataframe)</code> function</li>
<li>To view the top of a dataframe, use <code>DataFrame.head()</code></li>
<li>To view the bottom of a dataframe, use <code>DataFrame.tail()</code></li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> 
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>         <span class="n">D</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>  <span class="mf">0.469112</span> <span class="o">-</span><span class="mf">0.282863</span> <span class="o">-</span><span class="mf">1.509059</span> <span class="o">-</span><span class="mf">1.135632</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span>  <span class="mf">1.212112</span> <span class="o">-</span><span class="mf">0.173215</span>  <span class="mf">0.119209</span> <span class="o">-</span><span class="mf">1.044236</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="o">-</span><span class="mf">0.861849</span> <span class="o">-</span><span class="mf">2.104569</span> <span class="o">-</span><span class="mf">0.494929</span>  <span class="mf">1.071804</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span>  <span class="mf">0.721555</span> <span class="o">-</span><span class="mf">0.706771</span> <span class="o">-</span><span class="mf">1.039575</span>  <span class="mf">0.271860</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span> <span class="o">-</span><span class="mf">0.424972</span>  <span class="mf">0.567020</span>  <span class="mf">0.276232</span> <span class="o">-</span><span class="mf">1.087401</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> 
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>         <span class="n">D</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span>  <span class="mf">0.721555</span> <span class="o">-</span><span class="mf">0.706771</span> <span class="o">-</span><span class="mf">1.039575</span>  <span class="mf">0.271860</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span> <span class="o">-</span><span class="mf">0.424972</span>  <span class="mf">0.567020</span>  <span class="mf">0.276232</span> <span class="o">-</span><span class="mf">1.087401</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="o">-</span><span class="mf">0.673690</span>  <span class="mf">0.113648</span> <span class="o">-</span><span class="mf">1.478427</span>  <span class="mf">0.524988</span>
</code></pre></div>
<p>We can also explore the data with an IDE such as PyCharm, or we can export the DataFrame to a <code>.csv</code> file 
and open it with a spreadsheet editor.</p>
<h3 id="accessing-data-in-a-dataframe">Accessing data in a DataFrame<a class="headerlink" href="#accessing-data-in-a-dataframe" title="Permanent link">&para;</a></h3>
<p>There are 3 options to access the data of a pandas object:</p>
<ul>
<li><code>[]</code>, the "standard getter" which is highly overloaded</li>
<li><code>.loc[]</code>, label based selector</li>
<li><code>.iloc[],</code> integer location based selector</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>[]</code> operator is highly overloaded and its use is discouraged. Use <code>.loc[]</code> and <code>.iloc[]</code> whenever possible.</p>
</div>
<h4 id="accessing-data-in-one-ore-more-columns">Accessing data in one ore more columns<a class="headerlink" href="#accessing-data-in-one-ore-more-columns" title="Permanent link">&para;</a></h4>
<p>We can either use the standard getter <code>[]</code> or <code>.loc[]</code>.</p>
<p>With the standard getter it works like this (the return type is another DataFrame):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">my_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>  <span class="p">{</span><span class="s2">&quot;colA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="mf">4.5</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Eve&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">]},</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="p">)</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_dataframe</span><span class="p">[[</span><span class="mf">4.5</span><span class="p">]]</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>     <span class="mf">4.5</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="n">a</span>  <span class="n">Alice</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="n">b</span>    <span class="n">Eve</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="n">b</span>    <span class="n">Bob</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_dataframe</span><span class="p">[[</span><span class="mf">4.5</span><span class="p">,</span> <span class="s2">&quot;colA&quot;</span><span class="p">]]</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>     <span class="mf">4.5</span>  <span class="n">colA</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="n">a</span>  <span class="n">Alice</span>    <span class="mi">10</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="n">b</span>    <span class="n">Eve</span>    <span class="mi">20</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="n">b</span>    <span class="n">Bob</span>    <span class="mi">30</span>
</code></pre></div>
<p>To select columns with the <code>.loc[]</code> operator we use the syntax <code>my_dataframe.loc[:, col_selector]</code>. 
The <code>:</code> indicates that we want to select all rows (more on that later), and <code>col_selector</code> should be a
list of the columns that we want to select:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">my_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>  <span class="p">{</span><span class="s2">&quot;colA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="mf">4.5</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Eve&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">]},</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="p">)</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="mf">4.5</span><span class="p">]]</span>  <span class="c1"># returns a DataFrame</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>     <span class="mf">4.5</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="n">a</span>  <span class="n">Alice</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="n">b</span>    <span class="n">Eve</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="n">b</span>    <span class="n">Bob</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="n">c</span>    <span class="n">Charlie</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="mf">4.5</span><span class="p">,</span> <span class="s2">&quot;colA&quot;</span><span class="p">]]</span>  <span class="c1"># returns a DataFrame</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>     <span class="mf">4.5</span>  <span class="n">colA</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="n">a</span>  <span class="n">Alice</span>     <span class="mi">10</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="n">b</span>    <span class="n">Eve</span>     <span class="mi">20</span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="n">b</span>    <span class="n">Bob</span>     <span class="mi">30</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="n">c</span>    <span class="n">Charlie</span> <span class="mi">40</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In both examples we could have used a column name, instead of a list of column names, 
as a selector. In this case, the return type, instead of a DataFrame, would be a Pandas
Series. In general, <strong>try to avoid working with Series whenever possible</strong> and only use
methods that return DataFrames.</p>
</div>
<h4 id="slicing">Slicing<a class="headerlink" href="#slicing" title="Permanent link">&para;</a></h4>
<p>Slices act on row index, and are a way to access data from row X to row Y following the same 
logic as explained before: a slice <code>[1:3]</code> will return all members from 1 to 3, except for the last one
(i.e., 3 will be excluded). The return is a DataFrame:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">my_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>  <span class="p">{</span><span class="s2">&quot;colA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="mf">4.5</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Eve&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">]},</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="p">)</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_dataframe</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>   <span class="n">colA</span>  <span class="mf">4.5</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="n">b</span>    <span class="mi">20</span>  <span class="n">Eve</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="n">b</span>    <span class="mi">30</span>  <span class="n">Bob</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_dataframe</span><span class="p">[:</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>   <span class="n">colA</span>    <span class="mf">4.5</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="n">a</span>    <span class="mi">10</span>  <span class="n">Alice</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="n">b</span>    <span class="mi">20</span>    <span class="n">Eve</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="n">b</span>    <span class="mi">30</span>    <span class="n">Bob</span>
</code></pre></div>
<h4 id="selecting-rows-and-columns-at-the-same-time">Selecting rows and columns at the same time<a class="headerlink" href="#selecting-rows-and-columns-at-the-same-time" title="Permanent link">&para;</a></h4>
<p>To select rows with the <code>.loc[]</code> operator we use the syntax <code>my_dataframe.loc[row_selector, column_selector]</code>. 
As before, <code>column_selector</code> can be <code>:</code>, which indicates that we want to select all columns (but we could also 
put in here any list of columns we want).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>my_dataframe.loc[row_selector, :]</code> can also be written as <code>my_dataframe.loc[row_selector]</code>, without the
<code>:</code>. However, the first version is more explicit, and so its use is recommended.</p>
</div>
<p>We can select rows based on row name, row subset (by using a list, as with columns), a slice or, interestingly,
based on boolean conditions:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">my_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>  <span class="p">{</span><span class="s2">&quot;colA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="mf">4.5</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Eve&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">]},</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="p">)</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">],</span> <span class="p">:]</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>   <span class="n">colA</span>      <span class="mf">4.5</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="n">c</span>    <span class="mi">40</span>  <span class="n">Charlie</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="n">a</span>    <span class="mi">10</span>    <span class="n">Alice</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>   <span class="n">colA</span>      <span class="mf">4.5</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="mi">3</span>    <span class="mi">20</span>      <span class="n">Eve</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="mi">1</span>    <span class="mi">30</span>      <span class="n">Bob</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="mi">2</span>    <span class="mi">40</span>  <span class="n">Charlie</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">my_dataframe</span><span class="p">[</span><span class="s2">&quot;colA&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">]</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>       <span class="mf">4.5</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="n">c</span>  <span class="n">Charlie</span> 
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the last example we have used a simple "greater than" boolean condition to select data in the DataFrame,
but we can make this boolean condition as sophisticated or complex as we want, for example
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">]),</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">]</span>
</code></pre></div></p>
</div>
<h4 id="accessing-data-from-its-location-on-the-dataframe">Accessing data from its location on the DataFrame<a class="headerlink" href="#accessing-data-from-its-location-on-the-dataframe" title="Permanent link">&para;</a></h4>
<p>The <code>.iloc[]</code> operator works the same as <code>.loc[]</code>, but on integer location of rows and also columns. 
The syntax is the same, <code>my_dataframe[row_selector, column_selector]</code> and you can use <code>:</code> to indicate all rows or columns.</p>
<h5 id="column-selectors">Column selectors<a class="headerlink" href="#column-selectors" title="Permanent link">&para;</a></h5>
<ul>
<li>Selecting a single column (<code>my_dataframe.iloc[:, 1]</code>) always returns a Series.</li>
<li>Selecting a list of columns (<code>my_dataframe.iloc[:, [1]]</code>) always returns a DataFrame.</li>
</ul>
<h5 id="row-selectors">Row selectors<a class="headerlink" href="#row-selectors" title="Permanent link">&para;</a></h5>
<ul>
<li>Selecting a single integer position (<code>my_dataframe.iloc[1, :]</code>) always returns a Series.</li>
<li>Selecting with a list of integer positions (<code>my_dataframe.iloc[[1, 5], :]</code>) always returns a DataFrame.</li>
<li>Selecting with a slice of integer positions (<code>my_dataframe.iloc[1:4, :]</code>) always returns a DataFrame. 
Recall that the upper limit <strong>is excluded</strong>.</li>
<li>Selecting with a list of boolean indexes (<code>my_dataframe.iloc[1:4, :]</code>) always returns a DataFrame</li>
</ul>
<h3 id="setting-new-values-on-a-dataframe">Setting new values on a DataFrame<a class="headerlink" href="#setting-new-values-on-a-dataframe" title="Permanent link">&para;</a></h3>
<p>We can use the same methods that have been shown to access data <em>to set</em> new values to the DataFrame.
We just need to put the dataframe cell selection on the <strong>left side</strong> of a Python assignment, for example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># this assigns the value 10 to all cells in the column &quot;D&quot;</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;D&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c1"># this assigns the value 0 to all cells with negative values</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>
<h3 id="working-with-dataframes">Working with DataFrames<a class="headerlink" href="#working-with-dataframes" title="Permanent link">&para;</a></h3>
<p>This section describes very common methods or tasks that you will be performing with pandas DataFrames.
Before we start, however, one word of caution: DataFrames are <strong>objects</strong>, that derive from the 
<code>pandas.DataFrame</code> class. As objects, they have a lot of available methods that have been implemented
for the class, and we may think that when we call one of this methods, the original DataFrame might be
modified (since, after all, methods can change the attributes of the class). However, in pandas <strong>this
is not the case</strong>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, in pandas, dataframe operations return a copy of the dataframe and <em>leave the original 
dataframe</em> data intact.</p>
</div>
<p>Let's see this with an example. Assume we have the following dataframe <code>df</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="c1"># Output</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>  <span class="n">col1</span>  <span class="n">col2</span>  <span class="n">col3</span> <span class="n">col4</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="mi">0</span>    <span class="n">A</span>     <span class="mi">2</span>     <span class="mi">0</span>    <span class="n">a</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="mi">1</span>    <span class="n">A</span>     <span class="mi">1</span>     <span class="mi">1</span>    <span class="n">B</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="mi">2</span>    <span class="n">B</span>     <span class="mi">9</span>     <span class="mi">9</span>    <span class="n">c</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="mi">3</span>  <span class="n">NaN</span>     <span class="mi">8</span>     <span class="mi">4</span>    <span class="n">D</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="mi">4</span>    <span class="n">D</span>     <span class="mi">7</span>     <span class="mi">2</span>    <span class="n">e</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="mi">5</span>    <span class="n">C</span>     <span class="mi">4</span>     <span class="mi">3</span>    <span class="n">F</span>
</code></pre></div>
If we sort it by <code>col1</code> and then print <code>df</code> again, the result <strong>will not change</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">])</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="c1"># Output</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>  <span class="n">col1</span>  <span class="n">col2</span>  <span class="n">col3</span> <span class="n">col4</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="mi">0</span>    <span class="n">A</span>     <span class="mi">2</span>     <span class="mi">0</span>    <span class="n">a</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="mi">1</span>    <span class="n">A</span>     <span class="mi">1</span>     <span class="mi">1</span>    <span class="n">B</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="mi">2</span>    <span class="n">B</span>     <span class="mi">9</span>     <span class="mi">9</span>    <span class="n">c</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="mi">3</span>  <span class="n">NaN</span>     <span class="mi">8</span>     <span class="mi">4</span>    <span class="n">D</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="mi">4</span>    <span class="n">D</span>     <span class="mi">7</span>     <span class="mi">2</span>    <span class="n">e</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="mi">5</span>    <span class="n">C</span>     <span class="mi">4</span>     <span class="mi">3</span>    <span class="n">F</span>
</code></pre></div>
This is because these methods do not change the internal state (i.e., its attributes) of the <code>df</code> instance.
Hence, if we want to use the output of this method, we will need to save the <code>return</code> output of this methods
to another variable (or chain it):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">])</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c1"># Output</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>  <span class="n">col1</span>  <span class="n">col2</span>  <span class="n">col3</span> <span class="n">col4</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="mi">0</span>    <span class="n">A</span>     <span class="mi">2</span>     <span class="mi">0</span>    <span class="n">a</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="mi">1</span>    <span class="n">A</span>     <span class="mi">1</span>     <span class="mi">1</span>    <span class="n">B</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="mi">2</span>    <span class="n">B</span>     <span class="mi">9</span>     <span class="mi">9</span>    <span class="n">c</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="mi">5</span>    <span class="n">C</span>     <span class="mi">4</span>     <span class="mi">3</span>    <span class="n">F</span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="mi">4</span>    <span class="n">D</span>     <span class="mi">7</span>     <span class="mi">2</span>    <span class="n">e</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="mi">3</span>  <span class="n">NaN</span>     <span class="mi">8</span>     <span class="mi">4</span>    <span class="n">D</span>
</code></pre></div>
<p>Hence, if we want to "update" the DataFrame after a change, we will need to assign the output of the method
to the original variable, like:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">])</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We can make this functions modify the original dataframe with the optional parameter <code>inplace=True</code> (<code>False</code>
is the default). However, in general its use is discouraged.</p>
</div>
<h4 id="common-tasks">Common tasks<a class="headerlink" href="#common-tasks" title="Permanent link">&para;</a></h4>
<h5 id="finding-the-size-of-a-dataframe">Finding the size of a DataFrame<a class="headerlink" href="#finding-the-size-of-a-dataframe" title="Permanent link">&para;</a></h5>
<ul>
<li>To display the number of rows, columns, etc.: <code>df.info()</code></li>
<li>To get the number of rows and columns: <code>df.shape</code></li>
<li>To get the number of rows: <code>len(df)</code></li>
<li>To get the number of columns: <code>len(df.columns)</code></li>
</ul>
<p>We also have access to an attribute <code>df.empty</code>, of <code>bool</code> type, which returns <code>True</code> if the
DataFrame is empty and <code>False</code> otherwise.</p>
<h5 id="removing-duplicates">Removing duplicates<a class="headerlink" href="#removing-duplicates" title="Permanent link">&para;</a></h5>
<p>Pandas <code>drop_duplicates()</code> method helps in removing duplicates from Pandas Dataframes.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="n">data</span> <span class="o">=</span> <span class="p">{</span> 
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>    <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;TeamA&quot;</span><span class="p">,</span> <span class="s2">&quot;TeamB&quot;</span><span class="p">,</span> <span class="s2">&quot;TeamB&quot;</span><span class="p">,</span> <span class="s2">&quot;TeamC&quot;</span><span class="p">,</span> <span class="s2">&quot;TeamA&quot;</span><span class="p">],</span> 
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>    <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> 
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span> 
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="p">}</span> 
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> 
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="c1"># Output</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>       <span class="n">A</span>       <span class="n">B</span>      <span class="n">C</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="mi">0</span>    <span class="n">TeamA</span>    <span class="mi">50</span>    <span class="kc">True</span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="mi">1</span>    <span class="n">TeamB</span>    <span class="mi">40</span>    <span class="kc">False</span>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="mi">3</span>    <span class="n">TeamC</span>    <span class="mi">30</span>    <span class="kc">False</span>
</code></pre></div>
<h5 id="filling-missing-data">Filling missing data<a class="headerlink" href="#filling-missing-data" title="Permanent link">&para;</a></h5>
<p>We can use the <code>.isna()</code> method to detect (and fill, if we need to) cells without values:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>.isnull()</code> method is an alias for the <code>.isna()</code> method, so both are exactly the same.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pandas primarily uses the value <code>np.nan</code> to represent missing data. Missing data is by default 
not included in computations.</p>
</div>
<h5 id="resetting-the-index">Resetting the index<a class="headerlink" href="#resetting-the-index" title="Permanent link">&para;</a></h5>
<p>After dropping and filtering the rows of a DataFrame, the original index values for each row remain. 
If we want to re-create the index, dropping the original values, we can do it with
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></p>
<h5 id="renaming-columns">Renaming columns<a class="headerlink" href="#renaming-columns" title="Permanent link">&para;</a></h5>
<p>To rename specific columns of a DataFrame, we may use the <code>df.rename()</code> method:
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;oldName1&#39;</span><span class="p">:</span> <span class="s1">&#39;newName1&#39;</span><span class="p">,</span> <span class="s1">&#39;oldName2&#39;</span><span class="p">:</span> <span class="s1">&#39;newName2&#39;</span><span class="p">})</span>
</code></pre></div>
Only the columns in the dictionary passed as input will be renamed.</p>
<h5 id="sorting">Sorting<a class="headerlink" href="#sorting" title="Permanent link">&para;</a></h5>
<p>We can sort a DataFrame by the values of one or multiple columns, like so:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span> <span class="s1">&#39;col2&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>  <span class="n">col1</span>  <span class="n">col2</span>  <span class="n">col3</span> <span class="n">col4</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="mi">1</span>    <span class="n">A</span>     <span class="mi">1</span>     <span class="mi">1</span>    <span class="n">B</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="mi">0</span>    <span class="n">A</span>     <span class="mi">2</span>     <span class="mi">0</span>    <span class="n">a</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="mi">2</span>    <span class="n">B</span>     <span class="mi">9</span>     <span class="mi">9</span>    <span class="n">c</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="mi">5</span>    <span class="n">C</span>     <span class="mi">4</span>     <span class="mi">3</span>    <span class="n">F</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="mi">4</span>    <span class="n">D</span>     <span class="mi">7</span>     <span class="mi">2</span>    <span class="n">e</span>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="mi">3</span>  <span class="n">NaN</span>     <span class="mi">8</span>     <span class="mi">4</span>    <span class="n">D</span>
</code></pre></div>
<h5 id="creating-new-columns">Creating new columns<a class="headerlink" href="#creating-new-columns" title="Permanent link">&para;</a></h5>
<p>There are several ways to create a new column, but the most common one follow this syntax:
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="n">df</span><span class="p">[</span><span class="s2">&quot;new_column_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
</code></pre></div>
and on the <code>...</code> we can put whatever we want. For example, if we have a list <code>my_list</code> with the same
length as the DataFrame has rows, we could do:
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">df</span><span class="p">[</span><span class="s2">&quot;new_column_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_list</span>
</code></pre></div>
Alternatively, we could create a new column using the values from other columns, for example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="n">df</span><span class="p">[</span><span class="s2">&quot;new_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span>
</code></pre></div></p>
<h5 id="counting-unique-values">Counting unique values<a class="headerlink" href="#counting-unique-values" title="Permanent link">&para;</a></h5>
<p>The unique function in pandas is used to find the unique values from a series:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="c1"># Creating a dataframe</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Sports&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Football&#39;</span><span class="p">,</span> <span class="s1">&#39;Cricket&#39;</span><span class="p">,</span> <span class="s1">&#39;Baseball&#39;</span><span class="p">,</span> <span class="s1">&#39;Basketball&#39;</span><span class="p">,</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>                <span class="s1">&#39;Tennis&#39;</span><span class="p">,</span> <span class="s1">&#39;Table-tennis&#39;</span><span class="p">,</span> <span class="s1">&#39;Archery&#39;</span><span class="p">,</span> <span class="s1">&#39;Swimming&#39;</span><span class="p">,</span> <span class="s1">&#39;Boxing&#39;</span><span class="p">],</span> 
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>                <span class="s1">&#39;Player&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Messi&quot;</span><span class="p">,</span> <span class="s2">&quot;Afridi&quot;</span><span class="p">,</span> <span class="s2">&quot;Chad&quot;</span><span class="p">,</span> <span class="s2">&quot;Johnny&quot;</span><span class="p">,</span> <span class="s2">&quot;Federer&quot;</span><span class="p">,</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>                 <span class="s2">&quot;Yong&quot;</span><span class="p">,</span> <span class="s2">&quot;Mark&quot;</span><span class="p">,</span> <span class="s2">&quot;Phelps&quot;</span><span class="p">,</span> <span class="s2">&quot;Khan&quot;</span><span class="p">],</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>                 <span class="s1">&#39;Country&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Argentina&quot;</span><span class="p">,</span> <span class="s2">&quot;Pakistan&quot;</span><span class="p">,</span> <span class="s2">&quot;England&quot;</span><span class="p">,</span> <span class="s2">&quot;England&quot;</span><span class="p">,</span> <span class="s2">&quot;Switzerland&quot;</span><span class="p">,</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>                 <span class="s2">&quot;China&quot;</span><span class="p">,</span> <span class="s2">&quot;China&quot;</span><span class="p">,</span> <span class="s2">&quot;USA&quot;</span><span class="p">,</span> <span class="s2">&quot;Pakistan&quot;</span> <span class="p">],</span>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>                 <span class="s1">&#39;Rank&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">})</span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="c1"># Finding unique countries</span>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Country&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="c1"># Finding unique rankings</span>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Rank&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="c1"># Output</span>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a><span class="p">[</span><span class="s1">&#39;Argentina&#39;</span> <span class="s1">&#39;Pakistan&#39;</span> <span class="s1">&#39;England&#39;</span> <span class="s1">&#39;Switzerland&#39;</span> <span class="s1">&#39;China&#39;</span> <span class="s1">&#39;USA&#39;</span><span class="p">]</span>
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
</code></pre></div>
<h5 id="pivoting-a-dataframe-with-melt-untidy-to-tidy-data">Pivoting a dataframe with melt: untidy to tidy data<a class="headerlink" href="#pivoting-a-dataframe-with-melt-untidy-to-tidy-data" title="Permanent link">&para;</a></h5>
<p>The <code>pandas.melt()</code> function is used to transform or reshape data in a dataframe, transforming it from 
wide format to long format (this is sometimes called pivoting). 
The function takes a set of columns and converts it into a single column.</p>
<p><strong>Example 1</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">},</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="o">...</span>                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="o">...</span>                    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>   <span class="n">A</span>  <span class="n">B</span>  <span class="n">C</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="mi">0</span>  <span class="n">a</span>  <span class="mi">1</span>  <span class="mi">2</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="mi">1</span>  <span class="n">b</span>  <span class="mi">3</span>  <span class="mi">4</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="mi">2</span>  <span class="n">c</span>  <span class="mi">5</span>  <span class="mi">6</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>   <span class="n">A</span> <span class="n">variable</span>  <span class="n">value</span>
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a><span class="mi">0</span>  <span class="n">a</span>        <span class="n">B</span>      <span class="mi">1</span>
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="mi">1</span>  <span class="n">b</span>        <span class="n">B</span>      <span class="mi">3</span>
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a><span class="mi">2</span>  <span class="n">c</span>        <span class="n">B</span>      <span class="mi">5</span>
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="mi">3</span>  <span class="n">a</span>        <span class="n">C</span>      <span class="mi">2</span>
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a><span class="mi">4</span>  <span class="n">b</span>        <span class="n">C</span>      <span class="mi">4</span>
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a><span class="mi">5</span>  <span class="n">c</span>        <span class="n">C</span>      <span class="mi">6</span>
</code></pre></div>
<p><strong>Example 2</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>    <span class="p">{</span>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>        <span class="s2">&quot;first&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Mary&quot;</span><span class="p">],</span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>        <span class="s2">&quot;last&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span> <span class="s2">&quot;Bo&quot;</span><span class="p">],</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>        <span class="s2">&quot;job&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Nurse&quot;</span><span class="p">,</span> <span class="s2">&quot;Economist&quot;</span><span class="p">],</span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>        <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">],</span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>        <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">130</span><span class="p">,</span> <span class="mi">150</span><span class="p">],</span>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>    <span class="p">}</span>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="p">)</span>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="n">melt_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">],</span> 
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>    <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;quantity&quot;</span><span class="p">,</span> 
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">]</span>
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="p">)</span>
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Unmelted: &quot;</span><span class="p">)</span>
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Melted: &quot;</span><span class="p">)</span>
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">melt_df</span><span class="p">)</span>
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a><span class="c1"># Output</span>
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a><span class="n">Unmelted</span><span class="p">:</span> 
<a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a>   <span class="n">first</span>  <span class="n">last</span>  <span class="n">job</span>         <span class="n">height</span>  <span class="n">weight</span>
<a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a><span class="mi">0</span>  <span class="n">John</span>   <span class="n">Doe</span>   <span class="n">Nurse</span>       <span class="mf">5.5</span>     <span class="mi">130</span>
<a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a><span class="mi">1</span>  <span class="n">Mary</span>   <span class="n">Bo</span>    <span class="n">Economist</span>   <span class="mf">6.0</span>     <span class="mi">150</span>
<a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a>
<a id="__codelineno-36-29" name="__codelineno-36-29" href="#__codelineno-36-29"></a><span class="n">Melted</span><span class="p">:</span> 
<a id="__codelineno-36-30" name="__codelineno-36-30" href="#__codelineno-36-30"></a>      <span class="n">first</span>     <span class="n">last</span>    <span class="n">quantity</span>   <span class="n">value</span>
<a id="__codelineno-36-31" name="__codelineno-36-31" href="#__codelineno-36-31"></a><span class="mi">0</span>     <span class="n">John</span>      <span class="n">Doe</span>     <span class="n">height</span>     <span class="mf">5.5</span>
<a id="__codelineno-36-32" name="__codelineno-36-32" href="#__codelineno-36-32"></a><span class="mi">1</span>     <span class="n">Mary</span>      <span class="n">Bo</span>      <span class="n">height</span>     <span class="mf">6.0</span>
<a id="__codelineno-36-33" name="__codelineno-36-33" href="#__codelineno-36-33"></a><span class="mi">2</span>     <span class="n">John</span>      <span class="n">Doe</span>     <span class="n">weight</span>     <span class="mf">130.0</span>
<a id="__codelineno-36-34" name="__codelineno-36-34" href="#__codelineno-36-34"></a><span class="mi">3</span>     <span class="n">Mary</span>      <span class="n">Bo</span>      <span class="n">weight</span>     <span class="mf">150.0</span>
</code></pre></div>
<h4 id="basic-statistics">Basic statistics<a class="headerlink" href="#basic-statistics" title="Permanent link">&para;</a></h4>
<p>There are many statistical operations already implemented in pandas. We can use them by selecting
a subset of the DataFrame (e.g., a few columns) and then calling these methods. Some of the most 
important are:</p>
<ul>
<li>The mean: <code>some_df.mean()</code></li>
<li>The median: <code>some_df.median()</code></li>
<li>The standard deviation: <code>some_df.std()</code></li>
<li>The min and max: <code>.min()</code> and <code>.max()</code></li>
<li>The number of records for each category in a column:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> 
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="n">Pclass</span>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="mi">3</span>    <span class="mi">491</span>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="mi">1</span>    <span class="mi">216</span>
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="mi">2</span>    <span class="mi">184</span>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="n">Name</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</code></pre></div></li>
</ul>
<p>There is also a helpful <code>.describe()</code> method that gives you several of these at the same time.</p>
<h4 id="applying-custom-functions">Applying custom functions<a class="headerlink" href="#applying-custom-functions" title="Permanent link">&para;</a></h4>
<p>The pandas DataFrame <code>apply()</code> function is used to apply a function along an axis of the DataFrame.
This function that we apply can be an external or a custom defined function. It works like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]})</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a>
<a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="c1"># Output</span>
<a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a>   <span class="n">A</span>   <span class="n">B</span>
<a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">10</span>
<a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a><span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">20</span>
<a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a>
<a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a>   <span class="n">A</span>    <span class="n">B</span>
<a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a><span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">100</span>
<a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="mi">1</span>  <span class="mi">4</span>  <span class="mi">400</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We don't need to apply the function to the whole dataframe. We can slice it and only apply
the function to a subset of the columns.</p>
</div>
<p>If you look at the above example, our <code>square()</code> function is very simple. We can easily convert it 
into a <strong>lambda</strong> function:
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</code></pre></div>
The output will remain the same as in the last example.</p>
<h4 id="group-by">Group by<a class="headerlink" href="#group-by" title="Permanent link">&para;</a></h4>
<p>The <code>groupby()</code> method is used for grouping the data according to the categories and applying a 
function to aggregate them categories. This is easier seen with an example. Suppose that 
we have the following dataframe:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>    <span class="p">{</span>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>     <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">],</span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>     <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;three&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;three&quot;</span><span class="p">],</span>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>     <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a>     <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>    <span class="p">}</span>
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="p">)</span>
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a>
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a>
<a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a><span class="c1"># Output</span>
<a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a>     <span class="n">A</span>      <span class="n">B</span>         <span class="n">C</span>         <span class="n">D</span>
<a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="mi">0</span>  <span class="n">foo</span>    <span class="n">one</span>  <span class="mf">0.845112</span>  <span class="mf">2.525473</span>
<a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a><span class="mi">1</span>  <span class="n">bar</span>    <span class="n">one</span> <span class="o">-</span><span class="mf">0.485309</span>  <span class="mf">0.067261</span>
<a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a><span class="mi">2</span>  <span class="n">foo</span>    <span class="n">two</span>  <span class="mf">1.106288</span>  <span class="mf">0.205404</span>
<a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a><span class="mi">3</span>  <span class="n">bar</span>  <span class="n">three</span> <span class="o">-</span><span class="mf">0.958754</span>  <span class="mf">0.923104</span>
<a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a><span class="mi">4</span>  <span class="n">foo</span>    <span class="n">two</span>  <span class="mf">2.033509</span> <span class="o">-</span><span class="mf">0.436023</span>
<a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a><span class="mi">5</span>  <span class="n">bar</span>    <span class="n">two</span> <span class="o">-</span><span class="mf">0.945948</span>  <span class="mf">0.869062</span>
<a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a><span class="mi">6</span>  <span class="n">foo</span>    <span class="n">one</span> <span class="o">-</span><span class="mf">0.288766</span> <span class="o">-</span><span class="mf">1.497993</span>
<a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a><span class="mi">7</span>  <span class="n">foo</span>  <span class="n">three</span>  <span class="mf">0.344638</span> <span class="o">-</span><span class="mf">0.786353</span>
</code></pre></div>
<p>We can ask ourselves what happens if we combine the data from all the columns that share
values in the columns <code>A</code> and <code>B</code> (e.g., all the columns that have <code>foo</code> in column <code>A</code> and <code>bar</code> in 
column <code>B</code>). </p>
<p>For this we need what's known as an aggregating function. This function gives an answer to the following
question: assume that I found all the rows that share values in <code>A</code> and <code>B</code> and, somehow, I want to group
together the values in all the remaining columns. How do I do that? Do I calculate the mean of those values?
The sum? The minimum?</p>
<p>With Python's <code>groupby()</code> function we may use any aggregating function we want: the important thing to understand
is that this function will be applied to the set defined by all rows where <code>A</code> and <code>B</code> are shared.</p>
<p>Going back to the previous dataframe, and using the <code>sum()</code> function as an example, we could use it as:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="c1"># Output</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>     <span class="n">A</span>      <span class="n">B</span>         <span class="n">C</span>         <span class="n">D</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="mi">0</span>  <span class="n">bar</span>    <span class="n">one</span> <span class="o">-</span><span class="mf">0.485309</span>  <span class="mf">0.067261</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="mi">1</span>  <span class="n">bar</span>  <span class="n">three</span> <span class="o">-</span><span class="mf">0.958754</span>  <span class="mf">0.923104</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="mi">2</span>  <span class="n">bar</span>    <span class="n">two</span> <span class="o">-</span><span class="mf">0.945948</span>  <span class="mf">0.869062</span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="mi">3</span>  <span class="n">foo</span>    <span class="n">one</span>  <span class="mf">0.556346</span>  <span class="mf">1.027480</span>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="mi">4</span>  <span class="n">foo</span>  <span class="n">three</span>  <span class="mf">0.344638</span> <span class="o">-</span><span class="mf">0.786353</span>
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="mi">5</span>  <span class="n">foo</span>    <span class="n">two</span>  <span class="mf">3.139796</span> <span class="o">-</span><span class="mf">0.230619</span>
</code></pre></div>
<p>The syntax is always the same: <code>df.groupby(list_of_columns_used_to_classify, as_index=False).some_func()</code>, where
<code>some_func()</code> is the function that is used to aggregate the columns that are not in <code>list_of_columns_used_to_classify</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the last example the <code>as_index=False</code> is important. If we don't use it, then the group by
will return a dataframe with a "strange" new index, created by the combination of the values
of <code>A</code> and <code>B</code>.</p>
</div>
<h4 id="joins-and-merges">Joins and merges<a class="headerlink" href="#joins-and-merges" title="Permanent link">&para;</a></h4>
<p>Pandas provides a single function, <code>merge()</code>, as the equivalent of standard SQL database join operations, 
but in this case between DataFrames.</p>
<p>Before getting into the details of how to use <code>merge()</code>, you should first understand the various forms of joins.
The idea of a merge (or <em>join</em>, as is known in SQL) is that we have two tables, and we stitch them together
on the basis of two columns (one from the first table, another from the second table) having the same value.
The resulting merged table will be the first table <em>glued</em> with the second table, with the shared column
acting as glue. This can be done in different ways:</p>
<ul>
<li><strong>inner merge</strong>: the resulting merged table will contain all the rows from the original tables that found a 
    match in the other table, but all rows (from either table) that find no match are discarded.</li>
<li><strong>outer merge</strong>: the opposite of the previous case: every row from either table will appear in the merged table,
    and if for some of them there is no match, we will get null values on the columns coming from the other table.</li>
<li><strong>left merge</strong>: this is an intermediate case between the inner and the outer merge. It behaves like the inner 
  merge, but we also keep the rows from the first ("left") table that have no matches.    </li>
<li><strong>right merge</strong>: like the left merge, but the table on the second table is <em>acting</em> as if it was the left table
  (usually we don't use the right merge for anything, since we can perform a left merge with the two tables in 
  the opposite order).</li>
</ul>
<p>These are some examples on how to use the <code>merge()</code> function:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="c1">#create DataFrame</span>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;team&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">],</span>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>                    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">28</span><span class="p">]})</span>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;team&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">],</span>
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>                    <span class="s1">&#39;assists&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">]})</span>
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="c1">#view DataFrames</span>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a>
<a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a>  <span class="n">team</span>  <span class="n">points</span>
<a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="mi">0</span>    <span class="n">A</span>      <span class="mi">18</span>
<a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a><span class="mi">1</span>    <span class="n">B</span>      <span class="mi">22</span>
<a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a><span class="mi">2</span>    <span class="n">C</span>      <span class="mi">19</span>
<a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a><span class="mi">3</span>    <span class="n">D</span>      <span class="mi">14</span>
<a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a><span class="mi">4</span>    <span class="n">E</span>      <span class="mi">14</span>
<a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a><span class="mi">5</span>    <span class="n">F</span>      <span class="mi">11</span>
<a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a><span class="mi">6</span>    <span class="n">G</span>      <span class="mi">20</span>
<a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a><span class="mi">7</span>    <span class="n">H</span>      <span class="mi">28</span>
<a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a>
<a id="__codelineno-42-23" name="__codelineno-42-23" href="#__codelineno-42-23"></a><span class="nb">print</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<a id="__codelineno-42-24" name="__codelineno-42-24" href="#__codelineno-42-24"></a>
<a id="__codelineno-42-25" name="__codelineno-42-25" href="#__codelineno-42-25"></a>  <span class="n">team</span>  <span class="n">assists</span>
<a id="__codelineno-42-26" name="__codelineno-42-26" href="#__codelineno-42-26"></a><span class="mi">0</span>    <span class="n">A</span>        <span class="mi">4</span>
<a id="__codelineno-42-27" name="__codelineno-42-27" href="#__codelineno-42-27"></a><span class="mi">1</span>    <span class="n">B</span>        <span class="mi">9</span>
<a id="__codelineno-42-28" name="__codelineno-42-28" href="#__codelineno-42-28"></a><span class="mi">2</span>    <span class="n">C</span>       <span class="mi">14</span>
<a id="__codelineno-42-29" name="__codelineno-42-29" href="#__codelineno-42-29"></a><span class="mi">3</span>    <span class="n">D</span>       <span class="mi">13</span>
<a id="__codelineno-42-30" name="__codelineno-42-30" href="#__codelineno-42-30"></a><span class="mi">4</span>    <span class="n">G</span>       <span class="mi">10</span>
<a id="__codelineno-42-31" name="__codelineno-42-31" href="#__codelineno-42-31"></a><span class="mi">5</span>    <span class="n">H</span>        <span class="mi">8</span>
<a id="__codelineno-42-32" name="__codelineno-42-32" href="#__codelineno-42-32"></a><span class="mi">6</span>    <span class="n">Z</span>       <span class="mi">15</span>
<a id="__codelineno-42-33" name="__codelineno-42-33" href="#__codelineno-42-33"></a>
<a id="__codelineno-42-34" name="__codelineno-42-34" href="#__codelineno-42-34"></a>
<a id="__codelineno-42-35" name="__codelineno-42-35" href="#__codelineno-42-35"></a><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;team&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<a id="__codelineno-42-36" name="__codelineno-42-36" href="#__codelineno-42-36"></a><span class="c1"># Output</span>
<a id="__codelineno-42-37" name="__codelineno-42-37" href="#__codelineno-42-37"></a>  <span class="n">team</span>  <span class="n">points</span>  <span class="n">assists</span>
<a id="__codelineno-42-38" name="__codelineno-42-38" href="#__codelineno-42-38"></a><span class="mi">0</span>    <span class="n">A</span>    <span class="mf">18.0</span>      <span class="mf">4.0</span>
<a id="__codelineno-42-39" name="__codelineno-42-39" href="#__codelineno-42-39"></a><span class="mi">1</span>    <span class="n">B</span>    <span class="mf">22.0</span>      <span class="mf">9.0</span>
<a id="__codelineno-42-40" name="__codelineno-42-40" href="#__codelineno-42-40"></a><span class="mi">2</span>    <span class="n">C</span>    <span class="mf">19.0</span>     <span class="mf">14.0</span>
<a id="__codelineno-42-41" name="__codelineno-42-41" href="#__codelineno-42-41"></a><span class="mi">3</span>    <span class="n">D</span>    <span class="mf">14.0</span>     <span class="mf">13.0</span>
<a id="__codelineno-42-42" name="__codelineno-42-42" href="#__codelineno-42-42"></a><span class="mi">4</span>    <span class="n">E</span>    <span class="mf">14.0</span>      <span class="n">NaN</span>
<a id="__codelineno-42-43" name="__codelineno-42-43" href="#__codelineno-42-43"></a><span class="mi">5</span>    <span class="n">F</span>    <span class="mf">11.0</span>      <span class="n">NaN</span>
<a id="__codelineno-42-44" name="__codelineno-42-44" href="#__codelineno-42-44"></a><span class="mi">6</span>    <span class="n">G</span>    <span class="mf">20.0</span>     <span class="mf">10.0</span>
<a id="__codelineno-42-45" name="__codelineno-42-45" href="#__codelineno-42-45"></a><span class="mi">7</span>    <span class="n">H</span>    <span class="mf">28.0</span>      <span class="mf">8.0</span>
<a id="__codelineno-42-46" name="__codelineno-42-46" href="#__codelineno-42-46"></a><span class="mi">8</span>    <span class="n">Z</span>     <span class="n">NaN</span>     <span class="mf">15.0</span>
<a id="__codelineno-42-47" name="__codelineno-42-47" href="#__codelineno-42-47"></a>
<a id="__codelineno-42-48" name="__codelineno-42-48" href="#__codelineno-42-48"></a><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;team&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<a id="__codelineno-42-49" name="__codelineno-42-49" href="#__codelineno-42-49"></a><span class="c1"># Output</span>
<a id="__codelineno-42-50" name="__codelineno-42-50" href="#__codelineno-42-50"></a>  <span class="n">team</span>  <span class="n">points</span>  <span class="n">assists</span>
<a id="__codelineno-42-51" name="__codelineno-42-51" href="#__codelineno-42-51"></a><span class="mi">0</span>    <span class="n">A</span>      <span class="mi">18</span>      <span class="mf">4.0</span>
<a id="__codelineno-42-52" name="__codelineno-42-52" href="#__codelineno-42-52"></a><span class="mi">1</span>    <span class="n">B</span>      <span class="mi">22</span>      <span class="mf">9.0</span>
<a id="__codelineno-42-53" name="__codelineno-42-53" href="#__codelineno-42-53"></a><span class="mi">2</span>    <span class="n">C</span>      <span class="mi">19</span>     <span class="mf">14.0</span>
<a id="__codelineno-42-54" name="__codelineno-42-54" href="#__codelineno-42-54"></a><span class="mi">3</span>    <span class="n">D</span>      <span class="mi">14</span>     <span class="mf">13.0</span>
<a id="__codelineno-42-55" name="__codelineno-42-55" href="#__codelineno-42-55"></a><span class="mi">4</span>    <span class="n">E</span>      <span class="mi">14</span>      <span class="n">NaN</span>
<a id="__codelineno-42-56" name="__codelineno-42-56" href="#__codelineno-42-56"></a><span class="mi">5</span>    <span class="n">F</span>      <span class="mi">11</span>      <span class="n">NaN</span>
<a id="__codelineno-42-57" name="__codelineno-42-57" href="#__codelineno-42-57"></a><span class="mi">6</span>    <span class="n">G</span>      <span class="mi">20</span>     <span class="mf">10.0</span>
<a id="__codelineno-42-58" name="__codelineno-42-58" href="#__codelineno-42-58"></a><span class="mi">7</span>    <span class="n">H</span>      <span class="mi">28</span>      <span class="mf">8.0</span>
<a id="__codelineno-42-59" name="__codelineno-42-59" href="#__codelineno-42-59"></a>
<a id="__codelineno-42-60" name="__codelineno-42-60" href="#__codelineno-42-60"></a><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;team&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<a id="__codelineno-42-61" name="__codelineno-42-61" href="#__codelineno-42-61"></a><span class="c1"># Output</span>
<a id="__codelineno-42-62" name="__codelineno-42-62" href="#__codelineno-42-62"></a>  <span class="n">team</span>  <span class="n">points</span>  <span class="n">assists</span>
<a id="__codelineno-42-63" name="__codelineno-42-63" href="#__codelineno-42-63"></a><span class="mi">0</span>    <span class="n">A</span>      <span class="mi">18</span>        <span class="mi">4</span>
<a id="__codelineno-42-64" name="__codelineno-42-64" href="#__codelineno-42-64"></a><span class="mi">1</span>    <span class="n">B</span>      <span class="mi">22</span>        <span class="mi">9</span>
<a id="__codelineno-42-65" name="__codelineno-42-65" href="#__codelineno-42-65"></a><span class="mi">2</span>    <span class="n">C</span>      <span class="mi">19</span>       <span class="mi">14</span>
<a id="__codelineno-42-66" name="__codelineno-42-66" href="#__codelineno-42-66"></a><span class="mi">3</span>    <span class="n">D</span>      <span class="mi">14</span>       <span class="mi">13</span>
<a id="__codelineno-42-67" name="__codelineno-42-67" href="#__codelineno-42-67"></a><span class="mi">4</span>    <span class="n">G</span>      <span class="mi">20</span>       <span class="mi">10</span>
<a id="__codelineno-42-68" name="__codelineno-42-68" href="#__codelineno-42-68"></a><span class="mi">5</span>    <span class="n">H</span>      <span class="mi">28</span>        <span class="mi">8</span>
</code></pre></div>
<h4 id="concatenating-dataframes">Concatenating DataFrames<a class="headerlink" href="#concatenating-dataframes" title="Permanent link">&para;</a></h4>
<p>If we have 2 or more DataFrames which share <em>exactly</em> the same columns, we can
concatenate them like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>   <span class="o">...</span><span class="p">:</span>     <span class="p">{</span>
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A0&quot;</span><span class="p">,</span> <span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">],</span>
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B0&quot;</span><span class="p">,</span> <span class="s2">&quot;B1&quot;</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="s2">&quot;B3&quot;</span><span class="p">],</span>
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="s2">&quot;C2&quot;</span><span class="p">,</span> <span class="s2">&quot;C3&quot;</span><span class="p">],</span>
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;D0&quot;</span><span class="p">,</span> <span class="s2">&quot;D1&quot;</span><span class="p">,</span> <span class="s2">&quot;D2&quot;</span><span class="p">,</span> <span class="s2">&quot;D3&quot;</span><span class="p">],</span>
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>   <span class="o">...</span><span class="p">:</span>     <span class="p">},</span>
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>   <span class="o">...</span><span class="p">:</span>     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>   <span class="o">...</span><span class="p">:</span> <span class="p">)</span>
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a>   <span class="o">...</span><span class="p">:</span> 
<a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a>
<a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a>   <span class="o">...</span><span class="p">:</span>     <span class="p">{</span>
<a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A4&quot;</span><span class="p">,</span> <span class="s2">&quot;A5&quot;</span><span class="p">,</span> <span class="s2">&quot;A6&quot;</span><span class="p">,</span> <span class="s2">&quot;A7&quot;</span><span class="p">],</span>
<a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B4&quot;</span><span class="p">,</span> <span class="s2">&quot;B5&quot;</span><span class="p">,</span> <span class="s2">&quot;B6&quot;</span><span class="p">,</span> <span class="s2">&quot;B7&quot;</span><span class="p">],</span>
<a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;C4&quot;</span><span class="p">,</span> <span class="s2">&quot;C5&quot;</span><span class="p">,</span> <span class="s2">&quot;C6&quot;</span><span class="p">,</span> <span class="s2">&quot;C7&quot;</span><span class="p">],</span>
<a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;D4&quot;</span><span class="p">,</span> <span class="s2">&quot;D5&quot;</span><span class="p">,</span> <span class="s2">&quot;D6&quot;</span><span class="p">,</span> <span class="s2">&quot;D7&quot;</span><span class="p">],</span>
<a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a>   <span class="o">...</span><span class="p">:</span>     <span class="p">},</span>
<a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a>   <span class="o">...</span><span class="p">:</span>     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a>   <span class="o">...</span><span class="p">:</span> <span class="p">)</span>
<a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a>   <span class="o">...</span><span class="p">:</span> 
<a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a>
<a id="__codelineno-43-23" name="__codelineno-43-23" href="#__codelineno-43-23"></a><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-43-24" name="__codelineno-43-24" href="#__codelineno-43-24"></a>   <span class="o">...</span><span class="p">:</span>     <span class="p">{</span>
<a id="__codelineno-43-25" name="__codelineno-43-25" href="#__codelineno-43-25"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A8&quot;</span><span class="p">,</span> <span class="s2">&quot;A9&quot;</span><span class="p">,</span> <span class="s2">&quot;A10&quot;</span><span class="p">,</span> <span class="s2">&quot;A11&quot;</span><span class="p">],</span>
<a id="__codelineno-43-26" name="__codelineno-43-26" href="#__codelineno-43-26"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B8&quot;</span><span class="p">,</span> <span class="s2">&quot;B9&quot;</span><span class="p">,</span> <span class="s2">&quot;B10&quot;</span><span class="p">,</span> <span class="s2">&quot;B11&quot;</span><span class="p">],</span>
<a id="__codelineno-43-27" name="__codelineno-43-27" href="#__codelineno-43-27"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;C8&quot;</span><span class="p">,</span> <span class="s2">&quot;C9&quot;</span><span class="p">,</span> <span class="s2">&quot;C10&quot;</span><span class="p">,</span> <span class="s2">&quot;C11&quot;</span><span class="p">],</span>
<a id="__codelineno-43-28" name="__codelineno-43-28" href="#__codelineno-43-28"></a>   <span class="o">...</span><span class="p">:</span>         <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;D8&quot;</span><span class="p">,</span> <span class="s2">&quot;D9&quot;</span><span class="p">,</span> <span class="s2">&quot;D10&quot;</span><span class="p">,</span> <span class="s2">&quot;D11&quot;</span><span class="p">],</span>
<a id="__codelineno-43-29" name="__codelineno-43-29" href="#__codelineno-43-29"></a>   <span class="o">...</span><span class="p">:</span>     <span class="p">},</span>
<a id="__codelineno-43-30" name="__codelineno-43-30" href="#__codelineno-43-30"></a>   <span class="o">...</span><span class="p">:</span>     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
<a id="__codelineno-43-31" name="__codelineno-43-31" href="#__codelineno-43-31"></a>   <span class="o">...</span><span class="p">:</span> <span class="p">)</span>
<a id="__codelineno-43-32" name="__codelineno-43-32" href="#__codelineno-43-32"></a>   <span class="o">...</span><span class="p">:</span> 
<a id="__codelineno-43-33" name="__codelineno-43-33" href="#__codelineno-43-33"></a>
<a id="__codelineno-43-34" name="__codelineno-43-34" href="#__codelineno-43-34"></a><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">]</span>
<a id="__codelineno-43-35" name="__codelineno-43-35" href="#__codelineno-43-35"></a>
<a id="__codelineno-43-36" name="__codelineno-43-36" href="#__codelineno-43-36"></a><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</code></pre></div>
<h4 id="variable-types-and-memory-usage">Variable types and memory usage<a class="headerlink" href="#variable-types-and-memory-usage" title="Permanent link">&para;</a></h4>
<p>A pandas DataFrame can have columns of different types. To find out what these are, we may
use <code>df.dtypes</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="c1"># Output</span>
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="nb">float</span>              <span class="n">float64</span>
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="nb">int</span>                  <span class="n">int64</span>
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="n">datetime</span>    <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span>
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="n">string</span>              <span class="nb">object</span>
<a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For very large datasets, make sure that you are not using more bits than you need in
the columns. You can transform the variable types, for example <code>int64</code> to <code>int16</code>, anytime.</p>
</div>
<p>To actually learn how much RAM memory (in Bytes) we are using for a particular DataFrame, we
may use the <code>df.memory_usage(deep=True)</code> function:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="p">(</span><span class="n">lists</span> <span class="n">each</span> <span class="n">column</span><span class="s1">&#39;s full memory usage)</span>
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="mi">462432</span>
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ba449ae6.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>