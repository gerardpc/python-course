
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../pandas/">
      
      
        <link rel="next" href="../../sql/introduction/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.3">
    
    
      
        <title>PySpark - Python and data science</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6b71719e.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pyspark" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Python and data science" class="md-header__button md-logo" aria-label="Python and data science" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Python and data science
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PySpark
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Python and data science" class="md-nav__button md-logo" aria-label="Python and data science" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Python and data science
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" tabindex="0" aria-expanded="false">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/python_introduction/" class="md-nav__link">
        Introduction to Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/control_flow/" class="md-nav__link">
        Control flow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/data_structures/" class="md-nav__link">
        Data structures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/functions/" class="md-nav__link">
        Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/python_programs/" class="md-nav__link">
        Python programs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/io_files/" class="md-nav__link">
        Input, output and files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/exceptions/" class="md-nav__link">
        Exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/classes/" class="md-nav__link">
        Classes and objects
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2_9" type="checkbox" id="__nav_2_9" >
      
      
      
        <label class="md-nav__link" for="__nav_2_9" tabindex="0" aria-expanded="false">
          Other topics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other topics" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_9">
          <span class="md-nav__icon md-icon"></span>
          Other topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/regular_expressions/" class="md-nav__link">
        Regular expressions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/comprehensions/" class="md-nav__link">
        Comprehensions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/python_packages/" class="md-nav__link">
        Python packages
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" tabindex="0" aria-expanded="true">
          Data science libraries
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data science libraries" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Data science libraries
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../numpy/" class="md-nav__link">
        Numpy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../matplotlib/" class="md-nav__link">
        Matplotlib
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pandas/" class="md-nav__link">
        Pandas
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          PySpark
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        PySpark
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-spark" class="md-nav__link">
    Setting up Spark
  </a>
  
    <nav class="md-nav" aria-label="Setting up Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-and-mac" class="md-nav__link">
    Windows and Mac
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    Linux
  </a>
  
    <nav class="md-nav" aria-label="Linux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-running-a-jupyter-notebook" class="md-nav__link">
    Option 1: running a Jupyter notebook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-using-google-colab" class="md-nav__link">
    Option 2: using Google Colab
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-3-running-pyspark-from-an-ide-eg-pycharm" class="md-nav__link">
    Option 3: running PySpark from an IDE (e.g. PyCharm)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyspark-dataframes" class="md-nav__link">
    PySpark DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pandas-vs-spark" class="md-nav__link">
    Pandas vs Spark
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-pyspark-dataframes" class="md-nav__link">
    Working with PySpark DataFrames
  </a>
  
    <nav class="md-nav" aria-label="Working with PySpark DataFrames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sparksession" class="md-nav__link">
    SparkSession
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframe-creation" class="md-nav__link">
    DataFrame Creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-data-inout" class="md-nav__link">
    Getting data In/Out
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-data" class="md-nav__link">
    Viewing Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-and-accessing-data" class="md-nav__link">
    Selecting and accessing data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-new-columns" class="md-nav__link">
    Creating new columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applying-a-function" class="md-nav__link">
    Applying a Function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fill-nanan-values" class="md-nav__link">
    Fill NA/NaN values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grouping-data" class="md-nav__link">
    Grouping Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joins" class="md-nav__link">
    Joins
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-sql" class="md-nav__link">
    Working with SQL
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" tabindex="0" aria-expanded="false">
          SQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SQL" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          SQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/introduction/" class="md-nav__link">
        SQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/select_statements/" class="md-nav__link">
        SELECT statement
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/window_functions/" class="md-nav__link">
        Window functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/modification_statements/" class="md-nav__link">
        Data modification statements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/table_operations/" class="md-nav__link">
        Table operations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/sql_from_python/" class="md-nav__link">
        SQL queries from Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-spark" class="md-nav__link">
    Setting up Spark
  </a>
  
    <nav class="md-nav" aria-label="Setting up Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-and-mac" class="md-nav__link">
    Windows and Mac
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    Linux
  </a>
  
    <nav class="md-nav" aria-label="Linux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-running-a-jupyter-notebook" class="md-nav__link">
    Option 1: running a Jupyter notebook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-using-google-colab" class="md-nav__link">
    Option 2: using Google Colab
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-3-running-pyspark-from-an-ide-eg-pycharm" class="md-nav__link">
    Option 3: running PySpark from an IDE (e.g. PyCharm)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyspark-dataframes" class="md-nav__link">
    PySpark DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pandas-vs-spark" class="md-nav__link">
    Pandas vs Spark
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-pyspark-dataframes" class="md-nav__link">
    Working with PySpark DataFrames
  </a>
  
    <nav class="md-nav" aria-label="Working with PySpark DataFrames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sparksession" class="md-nav__link">
    SparkSession
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframe-creation" class="md-nav__link">
    DataFrame Creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-data-inout" class="md-nav__link">
    Getting data In/Out
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-data" class="md-nav__link">
    Viewing Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-and-accessing-data" class="md-nav__link">
    Selecting and accessing data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-new-columns" class="md-nav__link">
    Creating new columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applying-a-function" class="md-nav__link">
    Applying a Function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fill-nanan-values" class="md-nav__link">
    Fill NA/NaN values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grouping-data" class="md-nav__link">
    Grouping Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joins" class="md-nav__link">
    Joins
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-sql" class="md-nav__link">
    Working with SQL
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="pyspark">PySpark<a class="headerlink" href="#pyspark" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p><strong>Spark</strong> is a platform for cluster computing. Spark lets you spread data and computations over clusters 
with multiple nodes (think of each node as a separate computer). Splitting up your data makes it easier 
to work with very large datasets because each node only works with a small amount of data. Hence,
Spark is a common tool for what is informally known as <em>big data</em> (for example, for cleaning it up or transforming
it into a more usable format).</p>
<p>As each node works on its own subset of the total data, it also carries out a part of the total 
calculations required, so that both data processing and computation are performed in parallel over 
the nodes in the cluster. </p>
<p><strong>PySpark</strong> is the Python API for Spark. Having a Python library that allows us to interact with Spark
using Python means that we can use Python to write code that will run on Spark clusters under the hood,
without having to learn Scala or Java.</p>
<h2 id="setting-up-spark">Setting up Spark<a class="headerlink" href="#setting-up-spark" title="Permanent link">&para;</a></h2>
<p>Setting up Spark is considerably more complicated than using Pandas, and it requires additional software. 
We should only use Spark when our data is too big to work with on a single machine, or when we need to
parallelize our computations for other reasons (e.g. to speed up the computations). If that is not the case,
we should use Pandas instead (or a Pandas alternative, like Polars).</p>
<h3 id="windows-and-mac">Windows and Mac<a class="headerlink" href="#windows-and-mac" title="Permanent link">&para;</a></h3>
<p>Follow the course slides to set up PySpark on your computer</p>
<h3 id="linux">Linux<a class="headerlink" href="#linux" title="Permanent link">&para;</a></h3>
<p>The easiest way to start using PySpark is with a docker image. We have two options</p>
<h4 id="option-1-running-a-jupyter-notebook">Option 1: running a Jupyter notebook<a class="headerlink" href="#option-1-running-a-jupyter-notebook" title="Permanent link">&para;</a></h4>
<p>Get the docker image from <a href="https://hub.docker.com/r/jupyter/pyspark-notebook">here</a> by running:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>docker<span class="w"> </span>pull<span class="w"> </span>jupyter/pyspark-notebook
</code></pre></div>
Then run the image with
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8888</span>:8888<span class="w"> </span>jupyter/pyspark-notebook
</code></pre></div>
After this two steps we can already write/run Python code with PySpark (from the notebook).</p>
<h4 id="option-2-using-google-colab">Option 2: using Google Colab<a class="headerlink" href="#option-2-using-google-colab" title="Permanent link">&para;</a></h4>
<p>Open a new google colab notebook and run
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>!pip<span class="w"> </span>install<span class="w"> </span>pyspark<span class="w"> </span>py4j
</code></pre></div>
on the first cell.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the most straightforward way to work with PySpark, but executions are rather slow.</p>
</div>
<h4 id="option-3-running-pyspark-from-an-ide-eg-pycharm">Option 3: running PySpark from an IDE (e.g. PyCharm)<a class="headerlink" href="#option-3-running-pyspark-from-an-ide-eg-pycharm" title="Permanent link">&para;</a></h4>
<ol>
<li>Install docker following the instructions <a href="https://docs.docker.com/engine/install/ubuntu/">here</a>.</li>
<li>Pull the docker image following the instructions <a href="https://hub.docker.com/r/apache/spark-py">here</a>.</li>
<li>Configure Pycharm to work with a remote <a href="https://www.jetbrains.com/help/pycharm/using-docker-as-a-remote-interpreter.html#config-docker">docker interpreter</a></li>
</ol>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>At a high level, every Spark application consists of a driver program that runs the user’s main 
function and executes various parallel operations on a cluster. The main abstraction Spark provides 
is a resilient distributed dataset (<strong>RDD</strong>), which is a collection of elements partitioned across the 
nodes of the cluster that can be operated on in parallel. RDDs are created by starting with a file 
(Hadoop file system or any other Hadoop-supported file system), or an existing driver program (a Scala collection),
and transforming it. Users may persist an RDD in memory to be reused across parallel operations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>RDDs automatically recover from node failures.</p>
</div>
<h3 id="pyspark-dataframes">PySpark DataFrames<a class="headerlink" href="#pyspark-dataframes" title="Permanent link">&para;</a></h3>
<p>PySpark's main object is the PySpark DataFrame (which is not the same as a Pandas DataFrame). 
PySpark DataFrames are implemented on top of RDDs and are lazily evaluated. 
This means that whenever we create a PySpark DataFrame, nothing happens until we call an action on it:
Spark does not immediately compute the transformation but plans how to compute later. </p>
<p>RDD actions are operations that actually return a value to the user program or write a value to storage,
and actually trigger the computation of a result. They can be:</p>
<ul>
<li><code>collect()</code>: return all the elements of the dataset as an array at the driver program. 
This is usually useful after a filter or other operation that returns a sufficiently small subset of the data.</li>
<li><code>count()</code>: return the number of elements in the dataset.</li>
<li><code>first()</code>: return the first element of the dataset.</li>
<li><code>take(n)</code>: return an array with the first n elements of the dataset.</li>
<li><code>reduce(func)</code>: aggregate the elements of the dataset using a function <code>func</code>.</li>
</ul>
<h3 id="pandas-vs-spark">Pandas vs Spark<a class="headerlink" href="#pandas-vs-spark" title="Permanent link">&para;</a></h3>
<p>PySpark DataFrames are conceptually equivalent to a Pandas DataFrame. The main difference is that
PySpark DataFrames are immutable, meaning that they cannot be changed after they are created. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Every time we perform an operation on a PySpark Dataframe, we are actually creating a <em>new</em>
dataframe.</p>
</div>
<p>This allows Spark to do more optimization under the hood.</p>
<h2 id="working-with-pyspark-dataframes">Working with PySpark DataFrames<a class="headerlink" href="#working-with-pyspark-dataframes" title="Permanent link">&para;</a></h2>
<h3 id="sparksession">SparkSession<a class="headerlink" href="#sparksession" title="Permanent link">&para;</a></h3>
<p>PySpark applications start with initializing SparkSession, which is the entry point of PySpark:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</code></pre></div>
<h3 id="dataframe-creation">DataFrame Creation<a class="headerlink" href="#dataframe-creation" title="Permanent link">&para;</a></h3>
<p>A PySpark DataFrame can be created via <code>pyspark.sql.SparkSession.createDataFrame</code> by several different ways.
This is similar to pandas, where we can create a DataFrame with data from different data structures.</p>
<p>For example, we can create a DataFrame by passing a list of lists, tuples, dictionaries or another
pandas DataFrame, and then an RDD consisting of such a list. 
<code>pyspark.sql.SparkSession.createDataFrame</code> takes the schema argument to specify the schema of the DataFrame.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A PySpark schema is a list that defines the name, type, and nullable/non-nullable information for each column
in a DataFrame.</p>
</div>
<p>When the schema is omitted, PySpark infers the corresponding schema by taking a sample from the data.</p>
<p>We can create a PySpark DataFrame from a list of rows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="n">Row</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;string1&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">e</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="n">Row</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;string2&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">e</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="n">Row</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;string3&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">e</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="p">])</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="c1"># Output</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="n">DataFrame</span><span class="p">[</span><span class="n">a</span><span class="p">:</span> <span class="n">bigint</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">]</span>
</code></pre></div>
<p>But we have other options to create a PySpark DataFrame, and sometimes they are more convenient:</p>
<ul>
<li>
<p>Create a PySpark DataFrame with an explicit schema</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="s1">&#39;string1&#39;</span><span class="p">,</span> <span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="s1">&#39;string2&#39;</span><span class="p">,</span> <span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="s1">&#39;string3&#39;</span><span class="p">,</span> <span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="p">],</span> <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;a long, b double, c string, d date, e timestamp&#39;</span><span class="p">)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="c1"># Output</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="n">DataFrame</span><span class="p">[</span><span class="n">a</span><span class="p">:</span> <span class="n">bigint</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">]</span>
</code></pre></div>
</li>
<li>
<p>Create a PySpark DataFrame from a pandas DataFrame</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">pandas_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;string1&#39;</span><span class="p">,</span> <span class="s1">&#39;string2&#39;</span><span class="p">,</span> <span class="s1">&#39;string3&#39;</span><span class="p">],</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="p">})</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">pandas_df</span><span class="p">)</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="c1"># Output</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="n">DataFrame</span><span class="p">[</span><span class="n">a</span><span class="p">:</span> <span class="n">bigint</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">]</span>
</code></pre></div>
</li>
</ul>
<p>All the DataFrames created above have the same content and schema.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># All DataFrames above result same.</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c1"># Output</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="o">+---+---+-------+----------+-------------------+</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="o">|</span>  <span class="n">a</span><span class="o">|</span>  <span class="n">b</span><span class="o">|</span>      <span class="n">c</span><span class="o">|</span>         <span class="n">d</span><span class="o">|</span>                  <span class="n">e</span><span class="o">|</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="o">+---+---+-------+----------+-------------------+</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span><span class="mf">2.0</span><span class="o">|</span><span class="n">string1</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span><span class="mf">3.0</span><span class="o">|</span><span class="n">string2</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span><span class="mf">4.0</span><span class="o">|</span><span class="n">string3</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="o">+---+---+-------+----------+-------------------+</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="n">root</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a> <span class="o">|--</span> <span class="n">a</span><span class="p">:</span> <span class="n">long</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a> <span class="o">|--</span> <span class="n">b</span><span class="p">:</span> <span class="n">double</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a> <span class="o">|--</span> <span class="n">c</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a> <span class="o">|--</span> <span class="n">d</span><span class="p">:</span> <span class="n">date</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a> <span class="o">|--</span> <span class="n">e</span><span class="p">:</span> <span class="n">timestamp</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To print a dataframe in table format, you can use <code>df.show()</code>.</p>
</div>
<h3 id="getting-data-inout">Getting data In/Out<a class="headerlink" href="#getting-data-inout" title="Permanent link">&para;</a></h3>
<p>Other common options to put data in/out of a DataFrame are to get data from a file.</p>
<ul>
<li>
<p>CSV files:
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">df</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s1">&#39;fruits.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s1">&#39;fruits.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c1"># Output</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="o">+-----+------+---+---+</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="o">|</span><span class="n">color</span><span class="o">|</span> <span class="n">fruit</span><span class="o">|</span> <span class="n">v1</span><span class="o">|</span> <span class="n">v2</span><span class="o">|</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="o">+-----+------+---+---+</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="o">|</span>  <span class="n">red</span><span class="o">|</span><span class="n">banana</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="o">|</span> <span class="n">blue</span><span class="o">|</span><span class="n">banana</span><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span> <span class="mi">20</span><span class="o">|</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="o">|</span>  <span class="n">red</span><span class="o">|</span><span class="n">carrot</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span> <span class="mi">30</span><span class="o">|</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="o">|</span> <span class="n">blue</span><span class="o">|</span> <span class="n">grape</span><span class="o">|</span>  <span class="mi">4</span><span class="o">|</span> <span class="mi">40</span><span class="o">|</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="o">|</span>  <span class="n">red</span><span class="o">|</span><span class="n">carrot</span><span class="o">|</span>  <span class="mi">5</span><span class="o">|</span> <span class="mi">50</span><span class="o">|</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="o">|</span><span class="n">black</span><span class="o">|</span><span class="n">carrot</span><span class="o">|</span>  <span class="mi">6</span><span class="o">|</span> <span class="mi">60</span><span class="o">|</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="o">|</span>  <span class="n">red</span><span class="o">|</span><span class="n">banana</span><span class="o">|</span>  <span class="mi">7</span><span class="o">|</span> <span class="mi">70</span><span class="o">|</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="o">|</span>  <span class="n">red</span><span class="o">|</span> <span class="n">grape</span><span class="o">|</span>  <span class="mi">8</span><span class="o">|</span> <span class="mi">80</span><span class="o">|</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="o">+-----+------+---+---+</span>
</code></pre></div></p>
</li>
<li>
<p>Parquet is an efficient and compact file format to read and write faster.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">df</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s1">&#39;fruits.parquet&#39;</span><span class="p">)</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s1">&#39;fruits.parquet&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c1"># Output</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="o">+-----+------+---+---+</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="o">|</span><span class="n">color</span><span class="o">|</span> <span class="n">fruit</span><span class="o">|</span> <span class="n">v1</span><span class="o">|</span> <span class="n">v2</span><span class="o">|</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="o">+-----+------+---+---+</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="o">|</span>  <span class="n">red</span><span class="o">|</span><span class="n">banana</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span> <span class="mi">10</span><span class="o">|</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="o">|</span> <span class="n">blue</span><span class="o">|</span><span class="n">banana</span><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span> <span class="mi">20</span><span class="o">|</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="o">|</span>  <span class="n">red</span><span class="o">|</span><span class="n">carrot</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span> <span class="mi">30</span><span class="o">|</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="o">|</span> <span class="n">blue</span><span class="o">|</span> <span class="n">grape</span><span class="o">|</span>  <span class="mi">4</span><span class="o">|</span> <span class="mi">40</span><span class="o">|</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="o">|</span>  <span class="n">red</span><span class="o">|</span><span class="n">carrot</span><span class="o">|</span>  <span class="mi">5</span><span class="o">|</span> <span class="mi">50</span><span class="o">|</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="o">|</span><span class="n">black</span><span class="o">|</span><span class="n">carrot</span><span class="o">|</span>  <span class="mi">6</span><span class="o">|</span> <span class="mi">60</span><span class="o">|</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="o">|</span>  <span class="n">red</span><span class="o">|</span><span class="n">banana</span><span class="o">|</span>  <span class="mi">7</span><span class="o">|</span> <span class="mi">70</span><span class="o">|</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="o">|</span>  <span class="n">red</span><span class="o">|</span> <span class="n">grape</span><span class="o">|</span>  <span class="mi">8</span><span class="o">|</span> <span class="mi">80</span><span class="o">|</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="o">+-----+------+---+---+</span>
</code></pre></div>
</li>
</ul>
<h3 id="viewing-data">Viewing Data<a class="headerlink" href="#viewing-data" title="Permanent link">&para;</a></h3>
<p>The top rows of a DataFrame can be displayed using <code>DataFrame.show(n)</code> (where <code>n</code> is the number of
printed rows).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c1"># Output</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="o">+---+---+-------+----------+-------------------+</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="o">|</span>  <span class="n">a</span><span class="o">|</span>  <span class="n">b</span><span class="o">|</span>      <span class="n">c</span><span class="o">|</span>         <span class="n">d</span><span class="o">|</span>                  <span class="n">e</span><span class="o">|</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="o">+---+---+-------+----------+-------------------+</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span><span class="mf">2.0</span><span class="o">|</span><span class="n">string1</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="o">+---+---+-------+----------+-------------------+</span>
</code></pre></div>
<p>only showing the first row. You can see the DataFrame’s schema and column names as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c1"># Output</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="n">df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="c1"># Output</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="n">root</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a> <span class="o">|--</span> <span class="n">a</span><span class="p">:</span> <span class="n">long</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a> <span class="o">|--</span> <span class="n">b</span><span class="p">:</span> <span class="n">double</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a> <span class="o">|--</span> <span class="n">c</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a> <span class="o">|--</span> <span class="n">d</span><span class="p">:</span> <span class="n">date</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a> <span class="o">|--</span> <span class="n">e</span><span class="p">:</span> <span class="n">timestamp</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
</code></pre></div>
<p>Show the summary of the DataFrame</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c1"># Output</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="o">+-------+---+---+-------+</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="o">|</span><span class="n">summary</span><span class="o">|</span>  <span class="n">a</span><span class="o">|</span>  <span class="n">b</span><span class="o">|</span>      <span class="n">c</span><span class="o">|</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="o">+-------+---+---+-------+</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="o">|</span>  <span class="n">count</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>      <span class="mi">3</span><span class="o">|</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="o">|</span>   <span class="n">mean</span><span class="o">|</span><span class="mf">2.0</span><span class="o">|</span><span class="mf">3.0</span><span class="o">|</span>   <span class="n">null</span><span class="o">|</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="o">|</span> <span class="n">stddev</span><span class="o">|</span><span class="mf">1.0</span><span class="o">|</span><span class="mf">1.0</span><span class="o">|</span>   <span class="n">null</span><span class="o">|</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="o">|</span>    <span class="nb">min</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span><span class="mf">2.0</span><span class="o">|</span><span class="n">string1</span><span class="o">|</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="o">|</span>    <span class="nb">max</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span><span class="mf">4.0</span><span class="o">|</span><span class="n">string3</span><span class="o">|</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="o">+-------+---+---+-------+</span>
</code></pre></div>
<p><code>DataFrame.collect()</code> collects the distributed data to the driver side as the local data in Python. 
Note that this can throw an out-of-memory error when the dataset is too large to fit in the driver side 
because it collects all the data from executors to the driver side.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># Output</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;string1&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">e</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a> <span class="n">Row</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;string2&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">e</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a> <span class="n">Row</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;string3&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">e</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">))]</span>
</code></pre></div>
<p>In order to avoid throwing an out-of-memory exception, use <code>DataFrame.take(n)</code> or <code>DataFrame.tail()</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">df</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1"># Output</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;string1&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">e</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">))]</span>
</code></pre></div>
<p>PySpark DataFrame also provides the conversion back to a pandas DataFrame. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># Output</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="n">a</span>   <span class="n">b</span>       <span class="n">c</span>           <span class="n">d</span>           <span class="n">e</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="mi">0</span>   <span class="mi">1</span>   <span class="mf">2.0</span>     <span class="n">string1</span>     <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="mi">1</span>   <span class="mi">2</span>   <span class="mf">3.0</span>     <span class="n">string2</span>     <span class="mi">2000</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="mi">2</span>   <span class="mi">3</span>   <span class="mf">4.0</span>     <span class="n">string3</span>     <span class="mi">2000</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>toPandas</code> also collects all data into the driver side, and that can easily cause an 
out-of-memory-error if the data is too large to fit into the driver side.</p>
</div>
<h3 id="selecting-and-accessing-data">Selecting and accessing data<a class="headerlink" href="#selecting-and-accessing-data" title="Permanent link">&para;</a></h3>
<p>PySpark DataFrame is lazily evaluated and simply selecting a column does not trigger a computation.
Instead, it returns a Column instance.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">df</span><span class="o">.</span><span class="n">a</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">Column</span><span class="o">&lt;</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">&gt;</span>
</code></pre></div>
<p>In fact, most column-wise operations return Columns.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Column</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">upper</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">upper</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c</span><span class="p">))</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">isNull</span><span class="p">())</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="kc">True</span>
</code></pre></div>
<p>These column objects can be used to get new DataFrames that are subsets of the original one.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c1"># Output</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="o">+-------+</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="o">|</span>      <span class="n">c</span><span class="o">|</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="o">+-------+</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="o">|</span><span class="n">string1</span><span class="o">|</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="o">|</span><span class="n">string2</span><span class="o">|</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="o">|</span><span class="n">string3</span><span class="o">|</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="o">+-------+</span>
</code></pre></div>
To select several columns, we would write either <code>df.select("col_1","col_2").show()</code> or
<code>df.select(df.col_1,df.col_2).show()</code> (they are equivalent).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To return the distinct values in a column, we can use <code>df.select(df.col_1).distinct().show()</code>.</p>
</div>
<ul>
<li>
<p>To select a subset of rows, we use the filter method <code>DataFrame.filter()</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="c1"># Output</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="o">+---+---+-------+----------+-------------------+</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="o">|</span>  <span class="n">a</span><span class="o">|</span>  <span class="n">b</span><span class="o">|</span>      <span class="n">c</span><span class="o">|</span>         <span class="n">d</span><span class="o">|</span>                  <span class="n">e</span><span class="o">|</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="o">+---+---+-------+----------+-------------------+</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span><span class="mf">2.0</span><span class="o">|</span><span class="n">string1</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="o">+---+---+-------+----------+-------------------+</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="c1"># Filter multiple condition</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">state</span>  <span class="o">==</span> <span class="s2">&quot;OH&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">gender</span>  <span class="o">==</span> <span class="s2">&quot;M&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="o">...</span>
</code></pre></div>
</li>
</ul>
<h3 id="creating-new-columns">Creating new columns<a class="headerlink" href="#creating-new-columns" title="Permanent link">&para;</a></h3>
<p><code>withColumn</code> is a DataFrame function that can be used for several different (but related things):
* Add a new column to DataFrame
* Change the value of an existing column
* Convert the datatype of a column
* Change the column name
* Apply a function to a column</p>
<p>For example, to create a new column that transforms the values of an existing column:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;upper_c&#39;</span><span class="p">,</span> <span class="n">upper</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="c1"># Output</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="o">+---+---+-------+----------+-------------------+-------+</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="o">|</span>  <span class="n">a</span><span class="o">|</span>  <span class="n">b</span><span class="o">|</span>      <span class="n">c</span><span class="o">|</span>         <span class="n">d</span><span class="o">|</span>                  <span class="n">e</span><span class="o">|</span><span class="n">upper_c</span><span class="o">|</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="o">+---+---+-------+----------+-------------------+-------+</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span><span class="mf">2.0</span><span class="o">|</span><span class="n">string1</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="n">STRING1</span><span class="o">|</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span><span class="mf">3.0</span><span class="o">|</span><span class="n">string2</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="n">STRING2</span><span class="o">|</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span><span class="mf">4.0</span><span class="o">|</span><span class="n">string3</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span><span class="o">|</span><span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">|</span><span class="n">STRING3</span><span class="o">|</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="o">+---+---+-------+----------+-------------------+-------+</span>
</code></pre></div>
<h3 id="applying-a-function">Applying a Function<a class="headerlink" href="#applying-a-function" title="Permanent link">&para;</a></h3>
<p>PySpark supports various user defined functions (UDFs) and APIs to allow users to execute Python native functions. 
For instance, the example below allows users to directly use the APIs in a pandas Series within a Python native function.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">pandas_udf</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="nd">@pandas_udf</span><span class="p">(</span><span class="s1">&#39;long&#39;</span><span class="p">)</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="k">def</span> <span class="nf">pandas_plus_one</span><span class="p">(</span><span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    <span class="c1"># Simply plus one by using pandas Series.</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    <span class="k">return</span> <span class="n">series</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pandas_plus_one</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">a</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="c1"># Output</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="o">+------------------+</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="o">|</span><span class="n">pandas_plus_one</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">|</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="o">+------------------+</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="o">|</span>                 <span class="mi">2</span><span class="o">|</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="o">|</span>                 <span class="mi">3</span><span class="o">|</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="o">|</span>                 <span class="mi">4</span><span class="o">|</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="o">+------------------+</span>
</code></pre></div>
<h3 id="fill-nanan-values">Fill NA/NaN values<a class="headerlink" href="#fill-nanan-values" title="Permanent link">&para;</a></h3>
<p>We can use <code>DataFrame.na.fill()</code> to replace NA/NaN values with a specified value.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">df</span><span class="o">.</span><span class="n">na</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</code></pre></div>
<h3 id="grouping-data">Grouping Data<a class="headerlink" href="#grouping-data" title="Permanent link">&para;</a></h3>
<p>The DataFrame also provides a way of handling grouped data. It groups the data by a certain 
condition, applies a function to each group and then combines them back to the DataFrame.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">simpleData</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;James&quot;</span><span class="p">,</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span><span class="s2">&quot;NY&quot;</span><span class="p">,</span><span class="mi">90000</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">10000</span><span class="p">),</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>    <span class="p">(</span><span class="s2">&quot;Michael&quot;</span><span class="p">,</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span><span class="s2">&quot;NY&quot;</span><span class="p">,</span><span class="mi">86000</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">20000</span><span class="p">),</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>    <span class="p">(</span><span class="s2">&quot;Robert&quot;</span><span class="p">,</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span><span class="mi">81000</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">23000</span><span class="p">),</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>    <span class="p">(</span><span class="s2">&quot;Maria&quot;</span><span class="p">,</span><span class="s2">&quot;Finance&quot;</span><span class="p">,</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span><span class="mi">90000</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">23000</span><span class="p">),</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>    <span class="p">(</span><span class="s2">&quot;Raman&quot;</span><span class="p">,</span><span class="s2">&quot;Finance&quot;</span><span class="p">,</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span><span class="mi">99000</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">24000</span><span class="p">),</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>    <span class="p">(</span><span class="s2">&quot;Scott&quot;</span><span class="p">,</span><span class="s2">&quot;Finance&quot;</span><span class="p">,</span><span class="s2">&quot;NY&quot;</span><span class="p">,</span><span class="mi">83000</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">19000</span><span class="p">),</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>    <span class="p">(</span><span class="s2">&quot;Jen&quot;</span><span class="p">,</span><span class="s2">&quot;Finance&quot;</span><span class="p">,</span><span class="s2">&quot;NY&quot;</span><span class="p">,</span><span class="mi">79000</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">15000</span><span class="p">),</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>    <span class="p">(</span><span class="s2">&quot;Jeff&quot;</span><span class="p">,</span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span><span class="mi">80000</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">18000</span><span class="p">),</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>    <span class="p">(</span><span class="s2">&quot;Kumar&quot;</span><span class="p">,</span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span><span class="s2">&quot;NY&quot;</span><span class="p">,</span><span class="mi">91000</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">21000</span><span class="p">)</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>  <span class="p">]</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="n">schema</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;employee_name&quot;</span><span class="p">,</span><span class="s2">&quot;department&quot;</span><span class="p">,</span><span class="s2">&quot;state&quot;</span><span class="p">,</span><span class="s2">&quot;salary&quot;</span><span class="p">,</span><span class="s2">&quot;age&quot;</span><span class="p">,</span><span class="s2">&quot;bonus&quot;</span><span class="p">]</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">simpleData</span><span class="p">,</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span><span class="p">)</span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="c1"># Output</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="o">+-------------+----------+-----+------+---+-----+</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="o">|</span><span class="n">employee_name</span><span class="o">|</span><span class="n">department</span><span class="o">|</span><span class="n">state</span><span class="o">|</span><span class="n">salary</span><span class="o">|</span><span class="n">age</span><span class="o">|</span><span class="n">bonus</span><span class="o">|</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="o">+-------------+----------+-----+------+---+-----+</span>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="o">|</span>        <span class="n">James</span><span class="o">|</span>     <span class="n">Sales</span><span class="o">|</span>   <span class="n">NY</span><span class="o">|</span> <span class="mi">90000</span><span class="o">|</span> <span class="mi">34</span><span class="o">|</span><span class="mi">10000</span><span class="o">|</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="o">|</span>      <span class="n">Michael</span><span class="o">|</span>     <span class="n">Sales</span><span class="o">|</span>   <span class="n">NY</span><span class="o">|</span> <span class="mi">86000</span><span class="o">|</span> <span class="mi">56</span><span class="o">|</span><span class="mi">20000</span><span class="o">|</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="o">|</span>       <span class="n">Robert</span><span class="o">|</span>     <span class="n">Sales</span><span class="o">|</span>   <span class="n">CA</span><span class="o">|</span> <span class="mi">81000</span><span class="o">|</span> <span class="mi">30</span><span class="o">|</span><span class="mi">23000</span><span class="o">|</span>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="o">|</span>        <span class="n">Maria</span><span class="o">|</span>   <span class="n">Finance</span><span class="o">|</span>   <span class="n">CA</span><span class="o">|</span> <span class="mi">90000</span><span class="o">|</span> <span class="mi">24</span><span class="o">|</span><span class="mi">23000</span><span class="o">|</span>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="o">|</span>        <span class="n">Raman</span><span class="o">|</span>   <span class="n">Finance</span><span class="o">|</span>   <span class="n">CA</span><span class="o">|</span> <span class="mi">99000</span><span class="o">|</span> <span class="mi">40</span><span class="o">|</span><span class="mi">24000</span><span class="o">|</span>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="o">|</span>        <span class="n">Scott</span><span class="o">|</span>   <span class="n">Finance</span><span class="o">|</span>   <span class="n">NY</span><span class="o">|</span> <span class="mi">83000</span><span class="o">|</span> <span class="mi">36</span><span class="o">|</span><span class="mi">19000</span><span class="o">|</span>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="o">|</span>          <span class="n">Jen</span><span class="o">|</span>   <span class="n">Finance</span><span class="o">|</span>   <span class="n">NY</span><span class="o">|</span> <span class="mi">79000</span><span class="o">|</span> <span class="mi">53</span><span class="o">|</span><span class="mi">15000</span><span class="o">|</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="o">|</span>         <span class="n">Jeff</span><span class="o">|</span> <span class="n">Marketing</span><span class="o">|</span>   <span class="n">CA</span><span class="o">|</span> <span class="mi">80000</span><span class="o">|</span> <span class="mi">25</span><span class="o">|</span><span class="mi">18000</span><span class="o">|</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a><span class="o">|</span>        <span class="n">Kumar</span><span class="o">|</span> <span class="n">Marketing</span><span class="o">|</span>   <span class="n">NY</span><span class="o">|</span> <span class="mi">91000</span><span class="o">|</span> <span class="mi">50</span><span class="o">|</span><span class="mi">21000</span><span class="o">|</span>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a><span class="o">+-------------+----------+-----+------+---+-----+</span>
</code></pre></div>
<p>Grouping and then applying the <code>sum()</code> function to the resulting groups.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;department&quot;</span><span class="p">,</span><span class="s2">&quot;state&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;salary&quot;</span><span class="p">,</span><span class="s2">&quot;bonus&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c1"># Output</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="o">+----------+-----+-----------+----------+</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="o">|</span><span class="n">department</span><span class="o">|</span><span class="n">state</span><span class="o">|</span><span class="nb">sum</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="o">|</span><span class="nb">sum</span><span class="p">(</span><span class="n">bonus</span><span class="p">)</span><span class="o">|</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="o">+----------+-----+-----------+----------+</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="o">|</span><span class="n">Finance</span>   <span class="o">|</span><span class="n">NY</span>   <span class="o">|</span><span class="mi">162000</span>     <span class="o">|</span><span class="mi">34000</span>     <span class="o">|</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="o">|</span><span class="n">Marketing</span> <span class="o">|</span><span class="n">NY</span>   <span class="o">|</span><span class="mi">91000</span>      <span class="o">|</span><span class="mi">21000</span>     <span class="o">|</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="o">|</span><span class="n">Sales</span>     <span class="o">|</span><span class="n">CA</span>   <span class="o">|</span><span class="mi">81000</span>      <span class="o">|</span><span class="mi">23000</span>     <span class="o">|</span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="o">|</span><span class="n">Marketing</span> <span class="o">|</span><span class="n">CA</span>   <span class="o">|</span><span class="mi">80000</span>      <span class="o">|</span><span class="mi">18000</span>     <span class="o">|</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="o">|</span><span class="n">Finance</span>   <span class="o">|</span><span class="n">CA</span>   <span class="o">|</span><span class="mi">189000</span>     <span class="o">|</span><span class="mi">47000</span>     <span class="o">|</span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="o">|</span><span class="n">Sales</span>     <span class="o">|</span><span class="n">NY</span>   <span class="o">|</span><span class="mi">176000</span>     <span class="o">|</span><span class="mi">30000</span>     <span class="o">|</span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="o">+----------+-----+-----------+----------+</span>
</code></pre></div>
<h3 id="joins">Joins<a class="headerlink" href="#joins" title="Permanent link">&para;</a></h3>
<p>The PySpark Join is used to combine two DataFrames from the values of two of their columns. 
It supports all basic join type operations available in traditional SQL:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">empDF</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c1"># Output</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="o">+------+--------+---------------+-----------+-----------+------+------+</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="o">|</span><span class="n">emp_id</span><span class="o">|</span><span class="n">name</span>    <span class="o">|</span><span class="n">superior_emp_id</span><span class="o">|</span><span class="n">year_joined</span><span class="o">|</span><span class="n">emp_dept_id</span><span class="o">|</span><span class="n">gender</span><span class="o">|</span><span class="n">salary</span><span class="o">|</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="o">+------+--------+---------------+-----------+-----------+------+------+</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="o">|</span><span class="mi">1</span>     <span class="o">|</span><span class="n">Smith</span>   <span class="o">|-</span><span class="mi">1</span>             <span class="o">|</span><span class="mi">2018</span>       <span class="o">|</span><span class="mi">10</span>         <span class="o">|</span><span class="n">M</span>     <span class="o">|</span><span class="mi">3000</span>  <span class="o">|</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="o">|</span><span class="mi">2</span>     <span class="o">|</span><span class="n">Rose</span>    <span class="o">|</span><span class="mi">1</span>              <span class="o">|</span><span class="mi">2010</span>       <span class="o">|</span><span class="mi">20</span>         <span class="o">|</span><span class="n">M</span>     <span class="o">|</span><span class="mi">4000</span>  <span class="o">|</span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="o">|</span><span class="mi">3</span>     <span class="o">|</span><span class="n">Williams</span><span class="o">|</span><span class="mi">1</span>              <span class="o">|</span><span class="mi">2010</span>       <span class="o">|</span><span class="mi">10</span>         <span class="o">|</span><span class="n">M</span>     <span class="o">|</span><span class="mi">1000</span>  <span class="o">|</span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="o">|</span><span class="mi">4</span>     <span class="o">|</span><span class="n">Jones</span>   <span class="o">|</span><span class="mi">2</span>              <span class="o">|</span><span class="mi">2005</span>       <span class="o">|</span><span class="mi">10</span>         <span class="o">|</span><span class="n">F</span>     <span class="o">|</span><span class="mi">2000</span>  <span class="o">|</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="o">|</span><span class="mi">5</span>     <span class="o">|</span><span class="n">Brown</span>   <span class="o">|</span><span class="mi">2</span>              <span class="o">|</span><span class="mi">2010</span>       <span class="o">|</span><span class="mi">40</span>         <span class="o">|</span>      <span class="o">|-</span><span class="mi">1</span>    <span class="o">|</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="o">|</span><span class="mi">6</span>     <span class="o">|</span><span class="n">Brown</span>   <span class="o">|</span><span class="mi">2</span>              <span class="o">|</span><span class="mi">2010</span>       <span class="o">|</span><span class="mi">50</span>         <span class="o">|</span>      <span class="o">|-</span><span class="mi">1</span>    <span class="o">|</span>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="o">+------+--------+---------------+-----------+-----------+------+------+</span>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="n">deptDF</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="c1"># Output</span>
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="o">+---------+-------+</span>
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="o">|</span><span class="n">dept_name</span><span class="o">|</span><span class="n">dept_id</span><span class="o">|</span>
<a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="o">+---------+-------+</span>
<a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="o">|</span><span class="n">Finance</span>  <span class="o">|</span><span class="mi">10</span>     <span class="o">|</span>
<a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="o">|</span><span class="n">Marketing</span><span class="o">|</span><span class="mi">20</span>     <span class="o">|</span>
<a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a><span class="o">|</span><span class="n">Sales</span>    <span class="o">|</span><span class="mi">30</span>     <span class="o">|</span>
<a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a><span class="o">|</span><span class="n">IT</span>       <span class="o">|</span><span class="mi">40</span>     <span class="o">|</span>
<a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a><span class="o">+---------+-------+</span>
<a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a>
<a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a>
<a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a><span class="c1"># Inner join</span>
<a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a><span class="n">empDF</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">deptDF</span><span class="p">,</span><span class="n">empDF</span><span class="o">.</span><span class="n">emp_dept_id</span> <span class="o">==</span> <span class="n">deptDF</span><span class="o">.</span><span class="n">dept_id</span><span class="p">,</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a>
<a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a><span class="c1"># Output</span>
<a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a><span class="o">+------+--------+---------------+-----------+-----------+------+------+---------+-------+</span>
<a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a><span class="o">|</span><span class="n">emp_id</span><span class="o">|</span><span class="n">name</span>    <span class="o">|</span><span class="n">superior_emp_id</span><span class="o">|</span><span class="n">year_joined</span><span class="o">|</span><span class="n">emp_dept_id</span><span class="o">|</span><span class="n">gender</span><span class="o">|</span><span class="n">salary</span><span class="o">|</span><span class="n">dept_name</span><span class="o">|</span><span class="n">dept_id</span><span class="o">|</span>
<a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a><span class="o">+------+--------+---------------+-----------+-----------+------+------+---------+-------+</span>
<a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a><span class="o">|</span><span class="mi">1</span>     <span class="o">|</span><span class="n">Smith</span>   <span class="o">|-</span><span class="mi">1</span>             <span class="o">|</span><span class="mi">2018</span>       <span class="o">|</span><span class="mi">10</span>         <span class="o">|</span><span class="n">M</span>     <span class="o">|</span><span class="mi">3000</span>  <span class="o">|</span><span class="n">Finance</span>  <span class="o">|</span><span class="mi">10</span>     <span class="o">|</span>
<a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a><span class="o">|</span><span class="mi">2</span>     <span class="o">|</span><span class="n">Rose</span>    <span class="o">|</span><span class="mi">1</span>              <span class="o">|</span><span class="mi">2010</span>       <span class="o">|</span><span class="mi">20</span>         <span class="o">|</span><span class="n">M</span>     <span class="o">|</span><span class="mi">4000</span>  <span class="o">|</span><span class="n">Marketing</span><span class="o">|</span><span class="mi">20</span>     <span class="o">|</span>
<a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a><span class="o">|</span><span class="mi">3</span>     <span class="o">|</span><span class="n">Williams</span><span class="o">|</span><span class="mi">1</span>              <span class="o">|</span><span class="mi">2010</span>       <span class="o">|</span><span class="mi">10</span>         <span class="o">|</span><span class="n">M</span>     <span class="o">|</span><span class="mi">1000</span>  <span class="o">|</span><span class="n">Finance</span>  <span class="o">|</span><span class="mi">10</span>     <span class="o">|</span>
<a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a><span class="o">|</span><span class="mi">4</span>     <span class="o">|</span><span class="n">Jones</span>   <span class="o">|</span><span class="mi">2</span>              <span class="o">|</span><span class="mi">2005</span>       <span class="o">|</span><span class="mi">10</span>         <span class="o">|</span><span class="n">F</span>     <span class="o">|</span><span class="mi">2000</span>  <span class="o">|</span><span class="n">Finance</span>  <span class="o">|</span><span class="mi">10</span>     <span class="o">|</span>
<a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a><span class="o">|</span><span class="mi">5</span>     <span class="o">|</span><span class="n">Brown</span>   <span class="o">|</span><span class="mi">2</span>              <span class="o">|</span><span class="mi">2010</span>       <span class="o">|</span><span class="mi">40</span>         <span class="o">|</span>      <span class="o">|-</span><span class="mi">1</span>    <span class="o">|</span><span class="n">IT</span>       <span class="o">|</span><span class="mi">40</span>     <span class="o">|</span>
<a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a><span class="o">+------+--------+---------------+-----------+-----------+------+------+---------+-------+</span>
</code></pre></div>
<p>In this last example we used <code>inner</code>, but we can also use:</p>
<ul>
<li><code>inner</code></li>
<li><code>left</code></li>
<li><code>outer</code></li>
</ul>
<h2 id="working-with-sql">Working with SQL<a class="headerlink" href="#working-with-sql" title="Permanent link">&para;</a></h2>
<p>An incredibly powerful option of PySpark DataFrames is that they can be queried with SQL.
For example, you can register a DataFrame as a table and run a SQL query on it easily as below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">&quot;tableA&quot;</span><span class="p">)</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT count(*) from tableA&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c1"># Output</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="o">+--------+</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="o">|</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="o">+--------+</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="o">|</span>       <span class="mi">8</span><span class="o">|</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="o">+--------+</span>
</code></pre></div>
<p>In addition, functions can be registered and invoked in SQL out of the box:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nd">@pandas_udf</span><span class="p">(</span><span class="s2">&quot;integer&quot;</span><span class="p">)</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">def</span> <span class="nf">add_one</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>    <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="n">spark</span><span class="o">.</span><span class="n">udf</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;add_one&quot;</span><span class="p">,</span> <span class="n">add_one</span><span class="p">)</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT add_one(v1) FROM tableA&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="c1"># Output</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="o">+-----------+</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="o">|</span><span class="n">add_one</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span><span class="o">|</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="o">+-----------+</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="o">|</span>          <span class="mi">2</span><span class="o">|</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="o">|</span>          <span class="mi">3</span><span class="o">|</span>
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="o">|</span>          <span class="mi">4</span><span class="o">|</span>
<a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="o">|</span>          <span class="mi">5</span><span class="o">|</span>
<a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="o">|</span>          <span class="mi">6</span><span class="o">|</span>
<a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a><span class="o">|</span>          <span class="mi">7</span><span class="o">|</span>
<a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="o">|</span>          <span class="mi">8</span><span class="o">|</span>
<a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a><span class="o">|</span>          <span class="mi">9</span><span class="o">|</span>
<a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="o">+-----------+</span>
</code></pre></div>
<p>These SQL expressions can directly be mixed and used as PySpark columns.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">expr</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="n">df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s1">&#39;add_one(v1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">expr</span><span class="p">(</span><span class="s1">&#39;count(*)&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="c1"># Output</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="o">+-----------+</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="o">|</span><span class="n">add_one</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span><span class="o">|</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="o">+-----------+</span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="o">|</span>          <span class="mi">2</span><span class="o">|</span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="o">|</span>          <span class="mi">3</span><span class="o">|</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="o">|</span>          <span class="mi">4</span><span class="o">|</span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="o">|</span>          <span class="mi">5</span><span class="o">|</span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="o">|</span>          <span class="mi">6</span><span class="o">|</span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="o">|</span>          <span class="mi">7</span><span class="o">|</span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="o">|</span>          <span class="mi">8</span><span class="o">|</span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="o">|</span>          <span class="mi">9</span><span class="o">|</span>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="o">+-----------+</span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="o">+--------------+</span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="o">|</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="o">+--------------+</span>
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a><span class="o">|</span>          <span class="n">true</span><span class="o">|</span>
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="o">+--------------+</span>
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ba449ae6.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>